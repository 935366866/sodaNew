<!DOCTYPE html>
<html>
<head>
	<title>查看任务</title>
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<meta http-equiv="content-type" content="text/html" ; charset="utf-8">
	<link href="public/css/reset.css" rel="stylesheet" />
	<link href="public/css/bootstrap.min.css" rel="stylesheet">
	<link href="public/css/bootstrap-table.css" rel="stylesheet">
	<link href="public/css/bootstrap-select.css" rel="stylesheet">
	<link href="public/css/jquery-ui-1.9.2.custom.css" rel="stylesheet" type="text/css" media="screen"  />
	<link href="public/css/long_common.css" rel="stylesheet"  media="all">

	<!--弹出层样式-->
	<link href="public/css/jquery.fancybox.css" rel="stylesheet"/>
	<link href="css/deepExcavation.css" rel="stylesheet" >
	<link href="css/soda_common.css" rel="stylesheet" >
			<!--轮播样式-->
	<link href="public/css/style-demo.css" rel="stylesheet" />
	<link href="public/draw/style/spectrum.css" rel="stylesheet"/>
</head>

<body>
	<!--前台公共头部-->
	<div class="top">
		<div class="main_nav1">
			<div class="container">
				<a href="#" class="logo"><img src="public/image/navLogo.svg"/></a>
				<ul class="main_nav1_left">
					<li id="main"><a href="main.html">首页</a></li>
					<li id="sodaIndex"><a href="sodaIndex.html">云中漫步</a></li>
					<li id="frontierResearch"><a href="frontierResearch.html" >前沿方案</a></li>
					<li id="marketActive"><a href="marketActive.html">市场活动</a></li>	
				</ul>
				<div class="form-group searchNews" id="search_news">
					<span class="col-sm-2 control-label"><img src="public/image/navSearch.svg"/></span>
					<div class="col-sm-10">
						<input type="text" class="form-control" id="search_news_input">
					</div>
				</div>
				<ul class="main_nav1_right">
					<li id="searchIcon"><a href="#"><img src="public/image/navSearch.svg" alt="搜索" /></a></li>
					<li><a href="#"><img src="public/image/navEmail.svg" alt="通知" /></a></li>
					<li><a href="personalCenter.html"><img src="public/image/navUser.svg" alt="用户" /></a></li>
				</ul>
			</div>
		</div>
		<div class="main_nav2">
			<div class="container">
				<ul class="main_nav2_left">
					<li class="nav2_list1" style="width: 90px;">
						<a href="#" class="active">流程方案<img src="public/image/navDown.svg" alt=""></a>
						<ul class="">
							<li><a href="">DNA流程方案</a></li>
							<li><a href="">RNA流程方案</a></li>
							<li><a href="">医学流程方案</a></li>
						</ul>				
					</li>
					<li class="nav2_list2" style="width: 73px;">
						<a href="#">小工具<img src="public/image/navDown.svg" alt=""></a>
						<ul class="">
							<li><a href="">基本绘图</a></li>
							<li><a href="">流程绘图</a></li>
							<li><a href="">高级绘图</a></li>
							<li><a href="">表格处理</a></li>
							<li><a href="">计算统计</a></li>
						</ul>
					</li>
					<li class=""><a href="myProject.html">我的项目</a></li>
					<li class=""><a href="#">我的目录</a></li>
					<li class=""><a href="recycle.html">回收站</a></li>
				</ul>
				<div class="form-group">
					<div class="col-sm-10">
						<input type="text" class="form-control" placeholder="搜索想要使用的流程或小工具" id="search_flowapp">
					</div>
					<button class="col-sm-2 btn btn_blue" id="search_button">搜索</button>				
				</div>
			</div>
		</div>	
	<div class="nav_line"></div>
		<div class="main_nav3" style="box-shadow:-2px 3px 9px 0px #ccc;">
			<div class="container">
				<ul class="main_nav3_left_report">
					<li><span id="showReport"><a >查看报告</a></span></li>
					<li ><span id="downloadReport"><a >下载报告</a></span></li>
					<!--云超，下载报告的链接-->
					<li><span ><a id="taskRerun"  href="#">重跑一次</a></span></li>
					<li><span style="background: #13438b;"><a id="deepBtn" style="color: #fff;" href="#">深度挖掘</a></span></li>
				</ul>
				<ul class="main_nav3_right_report">
					<li  class="report_success"><span id="taskStatus"  class="btn btn-primary"><a href="#">任务运行中</a></span></li>
	
								<!--<li class="report_running"><span><a href="#">任务运行中</a></span></li>
								<li class="report_end"><span><a href="#">任务已终止</a></span></li>
							-->
					<li id="refresh">
						<a href="#"><img src="img/refresh.svg" alt="刷新" /></a>
					</li>
					<li id="stop">
						<a href="#"><img src="img/stop.svg" alt="停止" /></a>
					</li>
					<li id="delete">
						<a href="#"><img src="img/delete.svg" alt="删除" /></a>
					</li>
				</ul>
			</div>
		</div>
	</div>
	<!--/前台公共头部-->
	 <div class="center_box" style="float:left;width:100%;margin-top: 145px;">
        <div class="myTab" style="background: #F8F8F8;"> 
        	<div class="tabs" style="margin-left: 20px;float: none;width: 1185px;margin: 0 auto;">
				<ul class="nav">
					<li style="width: 160px;"><a href="#KEGGPathScatter" data-toggle="tab">KEGG通路散点图</a></li>
					<li style="width: 60px;"><span style="display: inline-block;width: 35px;height: 35px;line-height: 35px; background: url(img/bg_01.png);font-size: 20px;">3</span></li>
					<li style="width: 160px;"><a href="#EnrichAnnotation" data-toggle="tab">差异基因富集注释</a></li>
					<li style="width: 60px;"><span style="display: inline-block;width: 35px;height: 35px;line-height: 35px; background: url(img/bg_01.png);font-size: 20px;">2</span></li>
					<li class="active"  style="width: 160px;" ><a href="#diffGeneFilter" data-toggle="tab">差异基因筛选</a></li>
					<li style="width: 60px;"><span style="display: inline-block;width: 35px;height: 35px;line-height: 35px; background: url(img/bg_01.png);font-size: 20px;">1</span></li>
				</ul>
			</div>	
        </div>       
		<div class="tab-content">
			<!--差异基因富集注释-->
			<div id="EnrichAnnotation" class="tab-pane tabContent" >
		        <div class="myTab">
		        	<div style="width: 1200px;margin: 0 auto;height: 100%;">
						<div class="tabs" style="margin-left: 10px;text-align: left;line-height: 88px;font-size: 15px;color: #656565;">
							<ul class="nav">
								<li style="width: 230px;"><a href="#previousGene" data-toggle="tab">使用上一步新差异基因注释</a></li>
								<li style="width: 230px;" class="active"><a href="#originalGene" data-toggle="tab">使用原始差异基因注释</a></li>
							</ul>
						</div>	
						
						<div class="tabs" style="width: 200px;height: 100px;">
						    <div class="custom-container default tabs" style="position: relative;margin-left: 30px;">
						        <a href="#" class="prev1" style="position: absolute;left: -16px;font-size: 30px;top: 25px;">&lsaquo;</a>
						        <div id="carousel0" class="carousel" style="width: 172px;height: 100px;margin: 0;top: 8px;">
						            <ul class="nav" style="top: 20px;">
						            	<li id="eaDirection" style="width: 172px;height: 39px;" class="active"><a href="#EADirection" data-toggle="tab">使用说明</a></li>
						            	<li style="width: 172px;height: 39px;" ><a href="#EAStatus" data-toggle="tab">任务状态</a></li>
						            	<li style="width: 172px;height: 39px;" ><a href="#EAKEGGList" data-toggle="tab">KEGG富集列表</a></li>
						            	<li style="width: 172px;height: 39px;" ><a href="#EAKEGGScatter" data-toggle="tab">KEGG散点图</a></li>
						            	<li style="width: 172px;height: 39px;" ><a href="#EAGOList" data-toggle="tab">GO富集列表</a></li>
						            	<li style="width: 172px;height: 39px;" ><a href="#EAGOBar" data-toggle="tab">GO富集柱状图</a></li>
						            	<li style="width: 172px;height: 39px;" ><a href="#EAGODag" data-toggle="tab">GO富集DAG图</a></li>	
						            </ul>
						        </div>
						        <a href="#" class="next1" style="position: absolute;right: 51px;font-size: 30px;top: 25px;">&rsaquo;</a>
						        <div class="clear"></div>
						    </div>
						</div>
					</div>	
				</div>
				<div style="width: 1185px;">
					<div class="tab-content input_l">
						<div class="tab-pane" id="previousGene">		
							<div class="panel  panel-default">				
								<div class="panel-body" style="height: 439px;">
									<form class="parameter" id="previousGeneParameter">
										<!--输出目录-->
										<div class="part">
											<div class="input_a_l titleNameLeft" >输出目录:</div>
											<div class="input_a_m" style="width: 345px;">
												<input  id="pgInput" name="pgInput" type="text" class="form-control">
											</div>
											<div class="input_a_r">
												<a onclick="opendir_path('pgInput')">
													<span class="glyphicon glyphicon-folder-open" style="font-size:20px; top: 5px; cursor:pointer;color:#7f8080;"></span>
												</a>	
											</div>
										</div>	
										<div class="part" style="display: none;">
											<input type="text" id="pGeneInput" name="pGeneInput" />
										</div>
										<div class="line"></div>
										<div class="part titleIndent">GO富集参数:</div>
										<div class="contentIndent">
											<div class="part">
												<div class="input_a_l titleNameLeft" >p值类型:</div>
												<div class="input_b_3" style="width: 305px;float: left;">
													<select id="pgpTypes"  name="pgpTypes" class="selectpicker select_width" autocomplete="off" >
														<option value="padj">correct</option>
														<option value="pval">over_represented_pvalue</option>
													</select>
												</div>									
											</div>
											<div class="part">
												<div class="input_a_l titleNameLeft">p值大小:</div>
												<div class="input_a_m" style="width: 305px;">
													<input  id="pgpValue" name="pgpValue" value="0.05" type="text" class="form-control">
												</div>								
											</div>
										</div>
										<div class="line"></div>
										<div class="part titleIndent">KEGG富集参数:</div>
										<div class="contentIndent">
											<div class="part">
												<div class="input_a_l titleNameLeft" style="width: 100px;">KEGG缩写:</div>
												<div class="input_b_3" style="width: 280px;float: left;">
													<select id="pgKeggAbb"  name="pgKeggAbb" class="selectpicker select_width" autocomplete="off" >
													</select>
												</div>									
											</div>
											<div class="part">
												<div class="input_a_l titleNameLeft" style="width: 100px;">E值:</div>
												<div class="input_a_m" style="width: 280px;">
													<input  id="pgEValue" name="pgEValue" value="1e-5" type="text" class="form-control">
												</div>								
											</div>
											<div class="part">
												<div class="input_a_l titleNameLeft" style="width: 100px;">统计检测方法:</div>
												<div class="input_b_3" style="width: 280px;float: left;">
													<select id="pgStatisMethod"  name="pgStatisMethod" class="selectpicker select_width" autocomplete="off" >
														<option value="b">binomial test</option>
														<option value="c">chi-square test</option>
														<option value="h">hypergeometric test/Fisher's exact test</option>
														<option value="x">frequency </option>
													</select>
												</div>									
											</div>
											<div class="part">
												<div class="input_a_l titleNameLeft" style="width: 100px;">FDR矫正方法:</div>
												<div class="input_b_3" style="width: 280px;float: left;">
													<select id="pgfdrMethod"  name="pgfdrMethod" class="selectpicker select_width" autocomplete="off" >
														<option value="BH ">Benjamini and Hochberg</option>
														<option value="BY ">Benjamini and Yekutieli</option>
														<option value="QVALUE">QVALUE</option>
														<option value="None">None</option>
													</select>
												</div>									
											</div>											
										</div>
									</form>
								</div>
								<div class="panel-footer" style="height: 51px;">
									<button id="eapSubmit_paras" type="button" class="btn btn-success submit">开始运行</button>
								</div>
							</div>
						</div>
						<div class="tab-pane active" id="originalGene">
							<div class="panel  panel-default">				
								<div class="panel-body" style="height: 439px;">
									<form class="parameter" id="originalGeneParameter">
										<!--输出目录-->
										<div class="part">
											<div class="input_a_l titleNameLeft">输出目录:</div>
											<div class="input_a_m" style="width: 345px;">
												<input  type="text" class="form-control" id="ogInput" name="ogInput" placeholder="">
											</div>
											<div class="input_a_r">
												<a onclick="opendir_path('ogInput','oGeneInput')">
													<span class="glyphicon glyphicon-folder-open" style="font-size:20px; top: 5px; cursor:pointer;color:#7f8080;"></span>
												</a>	
											</div>
										</div>	
										<div class="part" style="display: none;">
											<input type="text" id="oGeneInput" name="oGeneInput" />
										</div>
										<div class="line"></div>
										<div class="part titleIndent">GO富集参数:</div>
										<div class="contentIndent">
											<div class="part">
												<div class="input_a_l titleNameLeft">p值类型:</div>
												<div class="input_b_3" style="width: 305px;float: left;">
													<select id="ogpTypes"  name="ogpTypes" class="selectpicker select_width" autocomplete="off" >
														<option value="padj">correct</option>
														<option value="pval">over_represented_pvalue</option>
													</select>
												</div>									
											</div>
											<div class="part">
												<div class="input_a_l titleNameLeft">p值大小:</div>
												<div class="input_a_m" style="width: 305px;">
													<input id="ogpValue" name="ogpValue"  value="0.05" type="text" class="form-control" >
												</div>								
											</div>
										</div>
										<div class="line"></div>
										<div class="part titleIndent">KEGG富集参数:</div>
										<div class="contentIndent">
											<div class="part">
												<div class="input_a_l titleNameLeft" style="width: 100px;">KEGG缩写:</div>
												<div class="input_b_3" style="width: 280px;float: left;">
													<select id="ogKeggAbb"  name="ogKeggAbb" class="selectpicker select_width" autocomplete="off" >
													</select>
												</div>									
											</div>
											<div class="part">
												<div class="input_a_l titleNameLeft" style="width: 100px;">E值:</div>
												<div class="input_a_m" style="width: 280px;">
													<input id="ogEValue" name="ogEValue" value="1e-5" type="text" class="form-control">
												</div>								
											</div>
											<div class="part">
												<div class="input_a_l titleNameLeft" style="width: 100px;">统计检测方法:</div>
												<div class="input_b_3" style="width: 280px;float: left;">
													<select id="ogStatisMethod"  name="ogStatisMethod" class="selectpicker select_width" autocomplete="off" >
														<option value="b">binomial test</option>
														<option value="c">chi-square test</option>
														<option value="h">hypergeometric test/Fisher's exact test</option>
														<option value="x">frequency </option>
													</select>
												</div>									
											</div>
											<div class="part">
												<div class="input_a_l titleNameLeft" style="width: 100px;">FDR矫正方法:</div>
												<div class="input_b_3" style="width: 280px;float: left;">
													<select id="ogfdrMethod"  name="ogfdrMethod" class="selectpicker select_width" autocomplete="off" >
														<option value="BH ">Benjamini and Hochberg</option>
														<option value="BY ">Benjamini and Yekutieli</option>
														<option value="QVALUE">QVALUE</option>
														<option value="None">None</option>
													</select>
												</div>									
											</div>
										</div>
									</form>
								</div>
								<div class="panel-footer" style="height: 51px;">
									<button id="eaoSubmit_paras" type="button" class="btn btn-success submit">开始运行</button>
								</div>
							</div>
						</div>
					</div>
					<div class="tab-content input_r">
						<!-- 使用说明 -->
						<div class="tab-pane in active" id="EADirection">
							<div class="panel panel-default">
								<div class="panel-body">
									<p style="font-weight: bolder;">描述：</p>
									<p class="indent">
									调整富集分析中参数，使用项目计算的差异数据或重新计算的差异数据，重新进行富集分析。
									</p>
									<p>参数填写：</p>
									<p class="indent">
										<p class="indent">1、选择输入差异数据</p>
										<p class="indent">选择使用原始差异基因注释选项卡，则使用项目计算的差异数据；选择使用上一步新差异基因注释选项卡，则使用上一步计算的差异数据。</p>
									</p>                                    
									<p class="indent">
										<p class="indent">2、选择输出目录</p>
										<p class="indent">计算过程文件和最终结果文件存放的根目录，建议与项目目录不同。若与项目目录相同，则会覆盖之前项目中差异分析的结果文件。</p>
									</p>
									<p class="indent">
										<p class="indent">3、设置GO富集阈值参数 </p>
										<p class="indent">p值类型：筛选富集条目时使用的p值类型。可选p值类型有correct和over_represented_pvalue。over_represented_pvalue是原始的富集p值，而correct则为校正后的p值。默认使用的p值的类型是correct。</p>
										<p class="indent">p值大小：筛选富集条目时使用的p值大小。默认为0.05</p>
									</p>
									<p class="indent">
										<p class="indent">3、设置KEGG富集参</p>
										<p class="indent">物种：KEGG注释参考物种。默认使用项目分析时设置的物种。</p>
										<p class="indent">E值：注释比对时使用的E值，默认为1e-5。</p>
										<p class="indent">统计检测方法：富集分析时使用的统计检测方法。可选方法有binomial test、chi-square test、hypergeometric test/Fisher's exact test和frequency，默认使用hypergeometric test/Fisher's exact test。</p>
										<p class="indent">FDR矫正方法：false discovery rate矫正方法。可选方法有BH（Benjamini and Hochberg）和BY（Benjamini and Yekutieli），默认使用BH。</p>                                        
									</p>
									<p>任务提交：</p>
									<p class="indent">
										在设置完所有参数后，点击run按钮，计算任务会在服务器上运行。
									</p>
									<p>结果查看：</p>
									<p class="indent">
										右侧任务状态选项卡可以查看计算任务的状态。在任务计算完成后，可以从右侧选项卡中查看主要结果文件。同样也可以在输出目录中找到结果文件，下载查看。
									</p>
								</div>
							</div>
						</div>
						<!-- 任务状态 -->
						<div class="tab-pane" id="EAStatus">
							<div class="panel panel-default">
								<div class="panel-body">
									<table data-toggle="table"  data-show-footer="false" data-sort-name="id" id="modStatusTable1">
										<thead>
											<tr>
												<th data-field="flow_mod" data-sortable="true">模块名称</th>
												<th data-field="task_name" data-sortable="true">程序名称</th>
												<th data-field="status" data-sortable="true" data-align="center" data-formatter="taskState">状态</th>
												<th data-field="submit_time" data-sortable="true" data-align="center">任务提交时间</th>
												<th data-field="done_time" data-sortable="true" data-align="center">任务结束时间</th>
												<th data-field="consume_time" data-sortable="true" data-align="center">时长</th>
											</tr>
										</thead>
									</table>
								</div>
							</div>
						</div>
						<!-- KEGG富集列表 -->
						<div class="tab-pane" id="EAKEGGList">
							<div class="panel panel-default">
								<div class="panel-body">
									<div style="margin-bottom: 50px;">
										<div style="display: inline-block;width: 60px;float: left;height: 34px;line-height: 34px;">比较组：</div>
										<div class="input_b_3" style="width: 260px;float: left;">
											<select  id="EAKEGGListCompareGroups"  name="EAKEGGListCompareGroups" class="selectpicker select_width" autocomplete="off">
											</select>
										</div>		
									</div>
									<table></table>
								</div>
							</div>
						</div>
						<!-- KEGG散点图 -->
						<div class="tab-pane" id="EAKEGGScatter">
							<div class="panel panel-default">
								<div class="panel-body">
									<div class="jcl-demo" style="width: 500px;height: 460px;">
									    <div class="custom-container default">
									        <a id="EAKEGGScatterPrev" href="#" class="prev">&lsaquo;</a>
									        <div id="EAKEGGScatterCarousel" class="carousel" style="width: 455px;height: 460px;">
									            <ul>
									            	<li style="width: 455px;height: 460px;" ><a class="fancybox-effects-a" href="" title="Lorem"><img style="width: 455px;height:460px;padding-right: 23px;" src="" alt="" /></a></li>
									            	<li style="width: 455px;height: 460px;" ><a class="fancybox-effects-a" href="" title="Lorem"><img style="width: 455px;height:460px;padding-right: 23px;" src="" alt="" /></a></li>
									            	<li style="width: 455px;height: 460px;" ><a class="fancybox-effects-a" href="" title="Lorem"><img style="width: 455px;height:460px;padding-right: 23px;" src="" alt="" /></a></li>
									            </ul>
									        </div>
									        <a id="EAKEGGScatterNext" href="#" class="next">&rsaquo;</a>
									        <div class="clear"></div>
									    </div>
									</div>
								</div>
							</div>
						</div>
						
						<!-- GO富集列表 -->
						<div class="tab-pane" id="EAGOList">
							<div class="panel panel-default">
								<div class="panel-body">
									<div style="margin-bottom: 50px;">
										<div style="display: inline-block;width: 60px;float: left;height: 34px;line-height: 34px;">比较组：</div>
										<div class="input_b_3" style="width: 260px;float: left;">
											<select  id="EAGOListCompareGroups"  name="EAKEGGListCompareGroups" class="selectpicker select_width" autocomplete="off">
											</select>
										</div>		
									</div>
									<table></table>
								</div>
							</div>
						</div>
						
						<!-- GO富集柱状图 -->
						<div class="tab-pane" id="EAGOBar">
							<div class="panel panel-default">
								<div class="panel-body">
									<div  class="jcl-demo" style="width: 500px;height: 460px;">
									    <div class="custom-container default">
									        <a id="EAGOBarPrev" href="#" class="prev">&lsaquo;</a>
									        <div id="EAGOBarCarousel" class="carousel" style="width: 455px;height: 460px;">
									            <ul>
									            	<li style="width: 455px;height: 460px;" ><a class="fancybox-effects-a" href="" title="Lorem"><img style="width: 455px;height:460px;padding-right: 23px;" src="" alt="" /></a></li>
									            	<li style="width: 455px;height: 460px;" ><a class="fancybox-effects-a" href="" title="Lorem"><img style="width: 455px;height:460px;padding-right: 23px;" src="" alt="" /></a></li>
									            	<li style="width: 455px;height: 460px;" ><a class="fancybox-effects-a" href="" title="Lorem"><img style="width: 455px;height:460px;padding-right: 23px;" src="" alt="" /></a></li>
									            </ul>
									        </div>
									        <a id="EAGOBarNext" href="#" class="next">&rsaquo;</a>
									        <div class="clear"></div>
									    </div>
									</div>
								</div>
							</div>
						</div>
						<!-- GO富集DAG图 -->
						<div class="tab-pane" id="EAGODag">
							<div class="panel panel-default">
								<div class="panel-body">
									<div  class="jcl-demo" style="width: 500px;height: 460px;">
									    <div class="custom-container default">
									        <a id="EAGODagPrev" href="#" class="prev">&lsaquo;</a>
									        <div id="EAGODagCarousel" class="carousel" style="width: 455px;height: 460px;">
									            <ul>
									            	<li style="width: 455px;height: 460px;" ><a class="fancybox-effects-a" href="" title="Lorem"><img style="width: 455px;height:460px;padding-right: 23px;" src="" alt="" /></a></li>
									            	<li style="width: 455px;height: 460px;" ><a class="fancybox-effects-a" href="" title="Lorem"><img style="width: 455px;height:460px;padding-right: 23px;" src="" alt="" /></a></li>
									            	<li style="width: 455px;height: 460px;" ><a class="fancybox-effects-a" href="" title="Lorem"><img style="width: 455px;height:460px;padding-right: 23px;" src="" alt="" /></a></li>
									            </ul>
									        </div>
									        <a id="EAGODagNext" href="#" class="next">&rsaquo;</a>
									        <div class="clear"></div>
									    </div>
									</div>
								</div>
							</div>
						</div>
					</div>
				</div>
			</div>
	        <!--KEGG通路散点图-->
			<div id="KEGGPathScatter" class="tab-pane tabContent" >
		        <div class="myTab" >
		        	<div style="width: 1200px;margin: 0 auto;height: 100%;">
						<div class="tabs" style="margin-left: 10px;text-align: left;line-height: 88px;font-size: 15px;color: #656565;">
							<ul class="nav">
								<li style="width: 232px;"><a href="#previousKEGGScatter" data-toggle="tab">使用上一步新KEGG通路绘图</a></li>
								<li style="width: 230px;" class="active"><a href="#originalKEGGScatter" data-toggle="tab">使用原始KEGG通路绘图</a></li>
							</ul>
						</div>	
						<div class="tabs" style="margin-left: 20px;">
							<ul class="nav">							
								<li><a href="#KEGGScatter" data-toggle="tab">KEGG散点图</a></li>
								<li ><a href="#KEGGStatus" data-toggle="tab">任务状态</a></li>
								<li class="active" ><a href="#KEGGDirection" data-toggle="tab">使用说明</a></li>	
							</ul>
						</div>
					</div>	
				</div>
				<div style="width: 1185px;">
					<div class="tab-content input_l">
						<div class="tab-pane" id="previousKEGGScatter">		
							<div class="panel  panel-default">				
								<div class="panel-body" style="height: 439px;">
									<form class="parameter" id="preKeggScaParameter">
										<div class="part">
											<div style="margin-bottom: 30px;">
												<div style="display: inline-block;width: 60px;float: left;height: 34px;line-height: 34px;">比较组：</div>
												<div class="input_b_3" style="width: 180px;float: left;margin-right: 40px;">
													<select  id="preKeggCompareGroups"  name="preKeggCompareGroups" class="selectpicker select_width" autocomplete="off">
													</select>
												</div>
												<div class="input_b_3" style="width:180px;float: left;">
													<select  id="preKeggAll"  name="preKeggAll" class="selectpicker select_width" autocomplete="off">
														<option value="ALL">ALL</option>
														<option value="UP">UP</option>
														<option value="DOWN">DOWN</option>
													</select>
												</div>		
											</div>
										</div>
										<div class="part">
											<table id="preKeggTable" data-height=260></table>	
										</div>
										<div class="line"></div>
										<!--输出目录-->
										<div class="part">
											<div class="input_a_l titleNameLeft">输出目录:</div>
											<div class="input_a_m" style="width: 345px;">
												<input id="pKeggScaInput" name="pKeggScaInput"  type="text" class="form-control" >
											</div>
											<div class="input_a_r">
												<a onclick="opendir_path('pKeggScaInput')">
													<span class="glyphicon glyphicon-folder-open" style="font-size:20px; top: 5px; cursor:pointer;color:#7f8080;"></span>
												</a>	
											</div>
										</div>	
										<div class="part" style="display: none;">
											<input type="text" id="preKeggInpputPath" name="preKeggInpputPath" />
										</div>
										<div class="part">
											<div class="input_a_l titleNameLeft">展示数目:</div>
											<div class="input_a_m" style="width: 345px;">
												<input id="preNum"  name="preNum" value="20"  type="text" class="form-control" >
											</div>
										</div>
										<div class="part">
											<div class="input_a_l titleNameLeft">缩放比例:</div>
											<div class="input_a_m" style="width: 345px;">
												<input id="preRatio"  name="preRatio" value="1" type="text" class="form-control" >
											</div>
										</div>	
										<div class="part">
											<div class="input_e_2 colorInput">
												最小值颜色:
											</div>
											<div class="input_c_4">
												<input id="preSamllColor" name="preSamllColor" value="red" type="text" class="form-control spectrum">
											</div>
											<div class="input_e_2 colorInput" style="margin-left: 10px;">
												中间颜色:
											</div>
											<div class="input_c_4">
												<input id="preMiddColor" name="preMiddColor" value="green" type="text" class="form-control spectrum">
											</div>
											<div class="input_e_2 colorInput" style="margin-left: 10px;">
												最大值颜色:
											</div>
											<div class="input_c_4">
												<input id="preBigColor" name="preBigColor" value="blue" type="text" class="form-control spectrum">
											</div>
										</div>
										<div class="line"></div>
										<div class="part titleIndent">标题:</div>
										<div class="contentIndent">
											<div class="part">
												<div class="input_a_l titleNameLeft">标题名称:</div>
												<div class="input_b_2 inputLeft">
													<input id="preTitleText" name="preTitleText" value="Statistics of Pathway Enrichment"  type="text" class="form-control">
												</div>
												<div class="right">
													<div class="input_a_l">字体大小:</div>
													<div class="input_b_2">
														<input id="preTitleFontsize" name="preTitleFontsize" value="16"  type="text" class="form-control" >
													</div>
												</div>
											</div>
											<div class="part">
												<div class="input_a_l titleNameLeft">字体颜色:</div>
												<div class="input_b_2 inputLeft">
													<input id="preTitleColor" name="preTitleColor" value="black" type="text" class="form-control spectrum">
												</div>
											</div>
										</div>	
										<div class="line"></div>
										<div class="part titleIndent">X轴:</div>
										<div class="contentIndent">
											<div class="part">
												<div class="input_a_l titleNameLeft">X轴名称:</div>
												<div class="input_b_2 inputLeft">
													<input id="preXText" name="preXText" value="Rich factor" type="text" class="form-control">
												</div>
												<div class="right">
													<div class="input_a_l">字体大小:</div>
													<div class="input_b_2">
														<input id="preXFontsize" name="preXFontsize" value="12" type="text" class="form-control" >
													</div>
												</div>
											</div>
											<div class="part">
												<div class="input_a_l titleNameLeft">字体颜色:</div>
												<div class="input_b_2 inputLeft">
													<input id="preXColor" name="preXColor" value="black" type="text" class="form-control spectrum">
												</div>
											</div>
										</div>
										<div class="line"></div>
										<div class="part titleIndent">Y轴:</div>
										<div class="contentIndent">
											<div class="part">
												<div class="input_a_l titleNameLeft">字体颜色:</div>
												<div class="input_b_2 inputLeft">
													<input id="preYColor" name="preYColor" value="black" type="text" class="form-control spectrum">
												</div>
												<div class="right">
													<div class="input_a_l">字体大小:</div>
													<div class="input_b_2">
														<input id="preYFontsize" value="12" name="preYFontsize" type="text" class="form-control">
													</div>
												</div>
											</div>
										</div>
										<div class="line"></div>
										<div class="part titleIndent">网格线:</div>
										<div class="contentIndent">
											<div class="part">
												<div class="input_a_l titleNameLeft">线条类型:</div>
												<div class="input_b_2 inputLeft">
													<select id="preLinestyle" name="preLinestyle" class="selectpicker select_width" autocomplete="off">
														<option value="dashdotted">dashdotted</option>
														<option value="none">none</option>
														<option value="dashed">dashed</option>
														<option value="dotted">dotted</option>
													</select>
												</div>
												<div class="right">
													<div class="input_a_l">坐标轴:</div>
													<div class="input_b_2">
														<select id="preAxis" name="preAxis" class="selectpicker select_width" autocomplete="off">
															<option value="both">both</option>
															<option value="x">x</option>
															<option value="y">y</option>
														</select>
													</div>
												</div>
											</div>
											<div class="part">
												<div class="input_a_l titleNameLeft">刻度:</div>
												<div class="input_b_2 inputLeft">
													<select id="preWhich" name="preWhich" class="selectpicker select_width" autocomplete="off">
														<option value="both">both</option>
														<option value="major">major</option>
														<option value="minor">minor</option>
													</select>
												</div>
												<div class="right">
													<div class="input_a_l">可见度:</div>
													<div class="input_b_2">
														<input id="preAlpha" name="preAlpha" type="text" class="form-control" value="0.5" />
													</div>
												</div>
											</div>
										</div>
									</form>
								</div>
								<div class="panel-footer" style="height: 51px;">
									<button id="kpspSubmit_paras" type="button" class="btn btn-success submit">开始运行</button>
								</div>
							</div>
						</div>
						<div class="tab-pane active" id="originalKEGGScatter">
							<div class="panel  panel-default">				
								<div class="panel-body" style="height: 439px;">
									<form class="parameter" id="orgKeggParameter">
										<div class="part">
											<div style="margin-bottom: 30px;">
												<div style="display: inline-block;width: 60px;float: left;height: 34px;line-height: 34px;">比较组：</div>
												<div class="input_b_3" style="width: 180px;float: left;margin-right: 40px;"">
													<select  id="oriKeggCompareGroups"  name="oriKeggCompareGroups" class="selectpicker select_width" autocomplete="off">
													</select>
												</div>	
												<div class="input_b_3" style="width:180px;float: left;">
													<select  id="oriKeggAll"  name="oriKeggAll" class="selectpicker select_width" autocomplete="off">
														<option value="ALL">ALL</option>
														<option value="UP">UP</option>
														<option value="DOWN">DOWN</option>
													</select>
												</div>	
											</div>
										</div>
										<div class="part">
											<table id="orgKeggTable" data-height=260>
											</table>	
										</div>
										<div class="line"></div>
										<!--输出目录-->
										<div class="part">
											<div class="input_a_l titleNameLeft">输出目录:</div>
											<div class="input_a_m" style="width: 345px;">
												<input id="oKeggScaInput" name="oKeggScaInput"  type="text" class="form-control">
											</div>
											<div class="input_a_r">
												<a onclick="opendir_path('oKeggScaInput')">
													<span class="glyphicon glyphicon-folder-open" style="font-size:20px; top: 5px; cursor:pointer;"></span>
												</a>
											</div>
										</div>
										<div class="part" style="display: none;">
											<input type="text" id="oriKeggInpputPath" name="oriKeggInpputPath" />
										</div>
										<div class="part">
											<div class="input_a_l titleNameLeft">展示数目:</div>
											<div class="input_a_m" style="width: 345px;">
												<input id="oriNum"  name="oriNum" value="20"  type="text" class="form-control" >
											</div>
										</div>
										<div class="part">
											<div class="input_a_l titleNameLeft">缩放比例:</div>
											<div class="input_a_m" style="width: 345px;">
												<input id="oriRatio"  name="oriRatio" value="1" type="text" class="form-control" >
											</div>
										</div>	
										<div class="part">
											<div class="input_e_2 colorInput">
												最小值颜色:
											</div>
											<div class="input_c_4">
												<input id="oriSamllColor" name="oriSamllColor" value="red"  type="text" class="form-control spectrum">
											</div>
											<div class="input_e_2 colorInput" style="margin-left: 10px;">
												中间颜色:
											</div>
											<div class="input_c_4">
												<input id="oriMiddColor" name="oriMiddColor" value="green" type="text" class="form-control spectrum">
											</div>
											<div class="input_e_2 colorInput" style="margin-left: 10px;">
												最大值颜色:
											</div>
											<div class="input_c_4">
												<input id="oriBigColor" name="oriBigColor" value="blue" type="text" class="form-control spectrum">
											</div>
										</div>
										<div class="line"></div>
										<div class="part titleIndent">标题:</div>
										<div class="contentIndent">
											<div class="part">
											<div class="input_a_l titleNameLeft">标题名称:</div>
											<div class="input_b_2 inputLeft">
													<input id="oriTitleText" name="oriTitleText" value="Statistics of Pathway Enrichment"  type="text" class="form-control">
												</div>
												<div class="right">
													<div class="input_a_l">字体大小:</div>
													<div class="input_b_2">
														<input id="oriTitleFontsize" name="oriTitleFontsize" value="16"  type="text" class="form-control" >
													</div>
												</div>
											</div>
											<div class="part">
												<div class="input_a_l titleNameLeft">字体颜色:</div>
												<div class="input_b_2 inputLeft">
													<input id="oriTitleColor" name="oriTitleColor" value="black" type="text" class="form-control spectrum">
												</div>
											</div>
										</div>
										<div class="line"></div>
										<div class="part titleIndent">X轴:</div>
										<div class="contentIndent">
											<div class="part">
												<div class="input_a_l titleNameLeft">X轴名称:</div>
												<div class="input_b_2 inputLeft">
													<input id="oriXText" name="oriXText" value="Rich factor" type="text" class="form-control">
												</div>
												<div class="right">
													<div class="input_a_l">字体大小:</div>
													<div class="input_b_2">
														<input id="oriXFontsize" name="oriXFontsize" value="12" type="text" class="form-control" >
													</div>
												</div>
											</div>
											<div class="part">
												<div class="input_a_l titleNameLeft">字体颜色:</div>
												<div class="input_b_2 inputLeft">
													<input id="oriXColor" name="oriXColor" value="black" type="text" class="form-control spectrum">
												</div>
											</div>
										</div>
										<div class="line"></div>
										<div class="part titleIndent">Y轴:</div>
										<div class="contentIndent">
											<div class="part">
												<div class="input_a_l titleNameLeft">字体颜色:</div>
												<div class="input_b_2 inputLeft">
													<input id="oriYColor" name="oriYColor" value="black" type="text" class="form-control spectrum">
												</div>
												<div class="right">
													<div class="input_a_l">字体大小:</div>
													<div class="input_b_2">
														<input id="oriYFontsize" value="12" name="oriYFontsize" type="text" class="form-control">
													</div>
												</div>
											</div>
										</div>
										<div class="line"></div>
										<div class="part titleIndent">网格线:</div>
										<div class="contentIndent">
											<div class="part">
												<div class="input_a_l titleNameLeft">线条类型:</div>
												<div class="input_b_2 inputLeft">
													<select id="oriLinestyle" name="oriLinestyle" class="selectpicker select_width" autocomplete="off">
														<option value="dashdotted">dashdotted</option>
														<option value="none">none</option>
														<option value="dashed">dashed</option>
														<option value="dotted">dotted</option>
													</select>
												</div>
												<div class="right">
													<div class="input_a_l">坐标轴:</div>
													<div class="input_b_2">
														<select id="oriAxis" name="oriAxis" class="selectpicker select_width" autocomplete="off">
															<option value="both">both</option>
															<option value="x">x</option>
															<option value="y">y</option>
														</select>
													</div>
												</div>
											</div>
											<div class="part">
												<div class="input_a_l titleNameLeft">刻度:</div>
												<div class="input_b_2 inputLeft">
													<select id="oriWhich" name="oriWhich" class="selectpicker select_width" autocomplete="off">
														<option value="both">both</option>
														<option value="major">major</option>
														<option value="minor">minor</option>
													</select>
												</div>
												<div class="right">
													<div class="input_a_l">可见度:</div>
													<div class="input_b_2">
														<input id="oriAlpha" name="oriAlpha" type="text" class="form-control" value="0.5" />
													</div>
												</div>
											</div>
										</div>
									</form>
								</div>
								<div class="panel-footer" style="height: 51px;">
									<button id="kpsoSubmit_paras" type="button" class="btn btn-success submit">开始运行</button>
								</div>
							</div>
						</div>
					</div>
					<div class="tab-content input_r">
						<!-- 使用说明 -->
						<div class="tab-pane in active" id="KEGGDirection">
							<div class="panel panel-default">
								<div class="panel-body">
									<p>描述：</p>
									<p class="indent">
									对提供的各样本中，各基因的表达量，按log（x+1）转换后，绘制小提琴图（https://en.wikipedia.org/wiki/Violin_plot）。用于展示各样本基因整体表达量分布情况。
									</p>
									<p>参数：</p>
									<pre>
										--input	  输入文件名。例如：fpkm.txt
										--output  输出目录名。后缀为.png时，输出png图片；后缀为.pdf时，输出pdf图片。例如：violin.png
										--ylab	  y坐标轴标题，默认为：log(RPKM+1)。例如：log(TPM+1)
										--title	  图标题，默认为：RPKM distribution。例如：TPM distribution	
									</pre>
									<p>输入：</p>
									<div class="indent">基因表达量文件，第一列为geneID，其他列为各样本中基因表达量值（FPKM，RPKM或TPM）。</div>
									<div class="img_box">
										<img src="public/draw/imgs/bg.jpg" alt="">
									</div>
									<p>输出：</p>
									<div class="indent">后缀为.png时，输出png图片；后缀为.pdf时，输出pdf图片。</div>
								</div>
							</div>
						</div>
						
						<!-- 任务状态 -->
						<div class="tab-pane" id="KEGGStatus">
							<div class="panel panel-default">
								<div class="panel-body">
									<table data-toggle="table" data-show-footer="false" data-sort-name="id" id="KEGGStatusTable">
										<thead>
											<tr>
												<th data-field="flow_mod" data-sortable="true">模块名称</th>
												<th data-field="task_name" data-sortable="true">程序名称</th>
												<th data-field="status" data-sortable="true" data-align="center" data-formatter="taskState">状态</th>
												<th data-field="submit_time" data-sortable="true" data-align="center">任务提交时间</th>
												<th data-field="done_time" data-sortable="true" data-align="center">任务结束时间</th>
												<th data-field="consume_time" data-sortable="true" data-align="center">时长</th>
											</tr>
										</thead>
									</table>
								</div>
							</div>
						</div>
						<!-- KEGG散点图 -->
						<div class="tab-pane" id="KEGGScatter">
							<div class="panel panel-default">
								<div class="panel-body">
									<div class="jcl-demo" style="width: 500px;height: 460px;">
									    <div class="custom-container default">
									        <a id="KEGGScatterPrev" href="#" class="prev">&lsaquo;</a>
									        <div id="KEGGScatterCarousel" class="carousel" style="width: 455px;height: 460px;">
									            <ul>
									            	<li style="width: 455px;height: 460px;" ><a class="fancybox-effects-a" href="" title="Lorem"><img style="width: 455px;height:460px;padding-right: 23px;" src="" alt="" /></a></li>
									            	<li style="width: 455px;height: 460px;" ><a class="fancybox-effects-a" href="" title="Lorem"><img style="width: 455px;height:460px;padding-right: 23px;" src="" alt="" /></a></li>
									            	<li style="width: 455px;height: 460px;" ><a class="fancybox-effects-a" href="" title="Lorem"><img style="width: 455px;height:460px;padding-right: 23px;" src="" alt="" /></a></li>
									            </ul>
									        </div>
									        <a id="KEGGScatterNext" href="#" class="next">&rsaquo;</a>
									        <div class="clear"></div>
									    </div>
									</div>
								</div>
							</div>
						</div>
						
					</div>
				</div>
			</div>
	        <!--差异基因筛选-->
	        <div id="diffGeneFilter" class="tab-pane active tabContent" > 
		        <div class="myTab" >
		        	<div style="width: 1200px;margin: 0 auto;height: 100%;">
						<div class="tabs leftTitle">
							差异基因筛选参数设置
						</div>	
						<div class="tabs" style="margin-left: 20px;">
							<ul class="nav" id="appTabRight">
								<li><a href="#dgfGeneList" data-toggle="tab">差异基因列表</a></li>
								<li><a href="#dgfShow" data-toggle="tab">火山图</a></li>
								<li><a href="#dgfStatus" data-toggle="tab">任务状态</a></li>
								<li class="active" ><a href="#dgfDirection" data-toggle="tab">使用说明</a></li>	
							</ul>
						</div>	
					</div>	
				</div>
				<div style="width: 1185px;">
					<div class="tab-content input_l">
						<div class="tab-pane in active">		
							<div class="panel  panel-default">				
								<div class="panel-body" style="height: 439px;">
									<form class="parameter" id="dgfParameter">
										<!--输出目录-->
										<div class="part">
											<div class="input_a_l titleNameLeft">输出目录:</div>
											<div class="input_a_m" style="width: 345px;">
												<input v-model="dgfInput" type="text" class="form-control" id="dgfInput" name="dgfInput" placeholder="">
											</div>
											<div class="input_a_r">
												<a onclick="opendir_path('dgfInput','dfgInputPath')">
													<span class="glyphicon glyphicon-folder-open" style="font-size:20px; top: 5px; cursor:pointer;color:#7f8080;"></span>
												</a>	
											</div>
										</div>	
										<div class="part" style="display: none;">
											<input type="text" id="dfgInputPath" name="dfgInputPath" />
										</div>
										<div class="line"></div>
										<div class="part">
											<div class="input_a_l titleNameLeft">筛选软件:</div>
											<div class="input_b_3" style="width: 345px;float: left;">
												<select id="filterCondition"  name="filterCondition" class="selectpicker select_width" autocomplete="off" >
													<option value="DESeq2">DESeq2</option>
													<option value="DESeq">DESeq</option>
													<option value="edgeR">edgeR</option>
													<option value="DEGseq">DEGseq</option>
												</select>
											</div>									
										</div>
										<div class="part">
											<div class="input_a_l titleNameLeft">p值类型:</div>
											<div class="input_b_3" style="width: 345px;float: left;">
												<select id="dgfPTypes"  name="dgfPTypes" class="selectpicker select_width" autocomplete="off" >
													<option value="padj">padj</option>
													<option value="pval">pval</option>
												</select>
											</div>									
										</div>
										<div class="part">
											<div class="input_a_l titleNameLeft">p值大小:</div>
											<div class="input_a_m" style="width: 345px;">
												<input v-model="dgfPValue" id="dgfPValue" name="dgfPValue" value="0.05" type="text" class="form-control">
											</div>								
										</div>
										<div class="part">
											<div class="input_a_l titleNameLeft">差异倍数:</div>
											<div class="input_a_m" style="width: 345px;">
												<input v-model="diffMultiple" type="text" class="form-control" id="diffMultiple" name="diffMultiple" value="2.0">
											</div>								
										</div>
										<div class="line"></div>
										<div class="part">
											<div style="float:left;width:22%;margin-left: 20px;height: 34px;line-height: 34px;">
												样本名称：
											</div>
											<div style="float:left;width:20%;margin-right: 20px;">
												<div>
													<button onclick="return false" class="btn btn-default" data-target='#groupModal' data-toggle='modal' style="outline: none;">
														<span class="glyphicon glyphicon-plus">Group</span>
													</button><br />
												</div>
											</div>
											<div style="float:left;width:22%;margin-right: 20px;">
												<div>
													<button onclick="return false" class="btn btn-default" data-target='#compareModal' data-toggle='modal'style="outline: none;">
														<span class="glyphicon glyphicon-plus">Compare</span>
													</button>
												</div>   
											</div>
											<div style="float:left;width:20%;margin-right: 20px;">
												<div>
													<button onclick="return false" class="btn btn-default"  data-target='#vennModal' data-toggle='modal' style="outline: none;">
														<span class="glyphicon glyphicon-plus">Venn</span>
													</button>
												</div>
											</div>
										</div>
										<div class="part">
											<div style="width:100%;">																				
												<div style="float:left;width:22%;margin-right: 20px;">
													<div id="sampleWrap">
														<ol id="sampleNames" class="list-group sampleNames ui-helper-reset ui-helper-clearfix" style="height: 100%;"></ol>
													</div>
												</div>
												<div id='groupList' style="float:left;width:20%;margin-right:20px;"></div>
												<div id='compareList' style="float:left;width:20%;margin-right:20px;"></div>
												<div id='vennList' style="float:left;width:20%"></div>																					
											</div>
										</div>
									</form>
								</div>
								<div class="panel-footer" style="height: 51px;">
									<button id="dgfSubmit_paras" type="button" class="btn btn-success submit">开始运行</button>
								</div>
							</div>
							<!-- group modal -->
							<div class="row">
								<div style="width:100%;">
									<div class="row">
										<div class="modal fade " id="groupModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
											<div class="row">
												<div id='list_model' class="modal-dialog " style='width:20%'>
													<div class="modal-content">
														<div class="modal-header">
															<button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
															<h4 class="modal-title" id="myModalLabel">组名</h4>
															<div class="input-group">
																<input id="groupName" class="form-control" value='' />
																<span id='addGroup' class='glyphicon glyphicon-circle-arrow-right input-group-addon'></span>
															</div>
														</div>
													</div>
												</div>
											</div>
										</div>
										<!-- /.modal end -->
									</div>
								</div>
							</div>
							<!-- compare modal -->
							<div class="row">
								<div style="width:100%;">
									<div class="row">
										<div class="modal fade " id="compareModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
											<div class="row">
												<div id='list_model' class="modal-dialog " style='width:20%'>
													<div class="modal-content">
														<div class="modal-header">
															<button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
															<h4 class="modal-title" id="myModalLabel">组间比较</h4>
															<div class="input-group">
																<input id="compareName" class="form-control" value='' />
																<span id='addCompare' class='glyphicon glyphicon-circle-arrow-right input-group-addon'></span>
															</div>
														</div>
													</div>
												</div>
											</div>
										</div>
										<!-- /.modal end -->
									</div>
								</div>
							</div>
							<!-- venn modal -->
							<div class="row">
								<div style="width:100%;">
									<div class="row">
										<div class="modal fade " id="vennModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
											<div class="row">
												<div id='list_model' class="modal-dialog " style='width:20%'>
													<div class="modal-content">
														<div class="modal-header">
															<button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
															<h4 class="modal-title" id="myModalLabel">维恩组</h4>
															<div class="input-group">
																<input id="vennName" class="form-control" value='' />
																<span id='addVenn' class='glyphicon glyphicon-circle-arrow-right input-group-addon'></span>
															</div>
														</div>
													</div>
												</div>
											</div>
										</div>
										<!-- /.modal end -->
									</div>
								</div>
							</div>
						</div>
					</div>
			
					<div class="tab-content input_r">
						<!-- 使用说明 -->
						<div class="tab-pane in active" id="dgfDirection">
							<div class="panel panel-default">
								<div class="panel-body">
									<p style="font-weight: bolder;">描述：</p>
									<p class="indent">
									调整差异分析参数，使用项目计算的定量数据，重新进行差异分析。
									</p>
									<p>参数填写：</p>
									<p class="indent">
										<p class="indent">1、选择输出目录</p>
										<p class="indent">计算过程文件和最终结果文件存放的根目录，建议与项目目录不同。若与项目目录相同，则会覆盖之前项目中差异分析的结果文件。</p>
									</p>
									<p class="indent">
										<p class="indent">2、选择比较差异基因的工具</p>
										<p class="indent">筛选软件：比较差异基因的工具。可选工具包括DESeq2、DESeq、edgeR和DEGSeq，默认使用DESeq2。DEGSeq用于无生物学重复的分析。</p>
									</p>
									<p class="indent">
										<p class="indent">3、设置差异基因筛选阈值</p>
										<p class="indent">p值类型：筛选差异基因时使用的p值类型。可选p值类型有pval和padj。pval是原始的富集p值，而padj则为校正后的p值。默认使用padj。</p>
										<p class="indent">p值大小：筛选差异基因时使用的p值大小，默认为0.05。</p>
										<p class="indent">差异倍数：筛选差异基因时使用的差异倍数（fold change），默认为2。</p>
									</p>
									<p class="indent">
										<p class="indent">4、设置分组信息</p>
										<p class="indent">根据需要调整分组和比较信息，默认按照原项目设置的分组信息进行后续分析。</p>
									</p>
									<p>任务提交：</p>
									<p class="indent">
										在设置完所有参数后，点击run按钮，计算任务会在服务器上运行。
									</p>
									<p>结果查看：</p>
									<p class="indent">
										右侧任务状态选项卡可以查看计算任务的状态。在任务计算完成后，可以从右侧选项卡中查看主要结果文件。在差异基因列表选项卡中，通过下拉框中选择比较组名，查看对应差异基因列表；在火山图选项卡中，通过点击左右按钮，滚动图片，查看各比较组的火山图。同样也可以在输出目录中找到结果文件，下载查看。
									</p>
								</div>
							</div>
						</div>
						
						<!-- 任务状态 -->
						<div class="tab-pane" id="dgfStatus">
							<div class="panel panel-default">
								<div class="panel-body">
									<table data-toggle="table"  data-show-footer="false" data-sort-name="id" id="dgfmodStatusTable">
										<thead>
											<tr>
												<th data-field="flow_mod" data-sortable="true">模块名称</th>
												<th data-field="task_name" data-sortable="true">程序名称</th>
												<th data-field="status" data-sortable="true" data-align="center" data-formatter="taskState">状态</th>
												<th data-field="submit_time" data-sortable="true" data-align="center">任务提交时间</th>
												<th data-field="done_time" data-sortable="true" data-align="center">任务结束时间</th>
												<th data-field="consume_time" data-sortable="true" data-align="center">时长</th>
											</tr>
										</thead>
									</table>
								</div>
							</div>
						</div>
						<!-- 基因列表 -->
						<div class="tab-pane" id="dgfGeneList">
							<div class="panel panel-default">
								<div class="panel-body">
									<div style="margin-bottom: 50px;">
										<div style="display: inline-block;width: 60px;float: left;height: 34px;line-height: 34px;">比较组：</div>
										<div class="input_b_3" style="width: 260px;float: left;">
											<select  id="compareGroups"  name="compareGroups" class="selectpicker select_width" autocomplete="off">
											</select>
										</div>		
									</div>
									<table ></table>
								</div>
							</div>
						</div>
						<!-- 绘图展示 -->
						<div class="tab-pane" id="dgfShow">
							<div class="panel panel-default">
								<div class="panel-body">
									<div class="jcl-demo" style="width: 500px;height: 460px;">
									    <div class="custom-container default">
									        <a href="#" id="dgfPrev" class="prev">&lsaquo;</a>
									        <div id="dgfCarousel" class="carousel" style="width: 455px;height: 460px;">
									            <ul>
									            	<li style="width: 455px;height: 460px;" id="li1"><a class="fancybox-effects-a" href="" title="Lorem"><img style="width: 455px;height:460px;padding-right: 23px;" src="" alt="" /></a></li>
									            	<li style="width: 455px;height: 460px;" id="li2"><a class="fancybox-effects-a" href="" title="Lorem"><img style="width: 455px;height:460px;padding-right: 23px;" src="" alt="" /></a></li>
									            	<li style="width: 455px;height: 460px;" id="li3"><a class="fancybox-effects-a" href="" title="Lorem"><img style="width: 455px;height:460px;padding-right: 23px;" src="" alt="" /></a></li>
									            </ul>
									        </div>
									        <a href="#" id="dgfNext" class="next">&rsaquo;</a>
									        <div class="clear"></div>
									    </div>
									</div>
								</div>
							</div>
						</div>
					</div>
				</div>
    		</div>
        </div>

	
	
	<!-- 添加选择目录的模态框 -->
	<div class="modal fade" id="selectUrl" tabindex="-1" aria-labelledby="选择路径" aria-hidden="true">

		<div class="modal-dialog" style="top:50px; width:800px;">
			<div class="modal-content ">
				<div class="modal-header">
					<button type="button" class="close" data-dismiss="modal" aria-hidden="true">
						&times;
					</button>
					<h4 class="modal-title">路径</h4>
					<div class="input-group">
						<input type="text" class="form-control" id="inputUrl">
						<span class="input-group-btn">
							<button class="btn btn-default glyphicon glyphicon-arrow-left" id="back" type="button" style="top: 0px;"></button>
							<button class="btn btn-default glyphicon glyphicon-arrow-right" id="search" type="button" style="top: 0px;"></button>
						</span>
					</div>
				</div>
				<!-- -----------------------------------------------------------data-single-select="true"------------------------ -->
				<div class="modal-body" style="text-align:center; ">
					<table data-toggle="table" data-url="json/jobUrl.json" data-minimum-count-columns="2" data-id-field="id" data-show-footer="false"
						data-height="300" data-sort-name="id" data-click-to-select="true" id="jobUrlTable"
						style="bottom:20px;">

						<thead>
							<tr>
								<th data-field="state" data-checkbox="true"></th>
								<th data-field="icon" data-formatter="addIcon"></th>
								<th data-field="name" data-align="left" data-sortable="true">name</th>
								<th data-field="type" data-align="center" data-sortable="true">attribute</th>
								<th data-field="inodeNum" data-align="center" data-visible="false" data-sortable="true">inodeNum</th>
								<th data-field="size" data-align="center" data-sortable="true">size</th>
								<th data-field="owner" data-align="center" data-sortable="true">owner</th>
								<th data-field="group" data-align="center">group</th>
								<th data-field="mtime" data-align="center" data-sortable="true">time</th>
							</tr>
						</thead>
					</table>
				</div>
				<!-- ----------------------------------------------------------------------------------- -->
				<div class="modal-footer">
					<button type="button" id="selected" class="btn btn-primary">
					选择
					</button>
					<button type="button" id="cancel" class="btn btn-default" data-dismiss="modal">
					关闭
					</button>

				</div>
			</div>
		</div>

	</div>

	<div id="footer_style">
		<footer class="footerstyle">
			<p>版权所有 © 2016 京ICP备15033925号</p>
			<p>北京拓美科基因科技有限公司</p>
		</footer>
	</div>
	<script src="public/js/jquery-1.9.1.min.js"></script>
	<script src="public/js/bootstrap.min.js"></script>
	<script src="public/js/bootstrap-table.js"></script>
	<script src="public/js/bootstrap-select.js"></script>
	<script src="public/js/jquery-ui-1.9.2.custom.min.js" type="text/javascript"></script>
	<script src="public/js/jquery.blockUI.js" type="text/javascript"></script>
	<!--轮播图片插件-->
	<script src="public/js/jquery.mousewheel-3.1.12.js"></script>
	<script src="public/js/jquery.jcarousellite.js"></script>
	<!--FancyBox弹出窗口插件-->
	<script src="public/js/jquery.mousewheel.pack.js"></script>
	<script src="public/js/jquery.fancybox.pack.js"></script>
	
	<script src="public/draw/script/spectrum.js"></script>
    <script src="public/draw/script/jquery.spectrum-zh-cn.js"></script>
	<script src="public/js/long_common.js"></script>
	<script src="js/go.js"></script>
	<script src="js/common1.js"></script>	
	<script>
		
	$(".spectrum").spectrum({
	    
	});
	$(document).ready(function() {
		$(".fancybox-effects-a").fancybox({
			width:500,
			height:500,
			helpers: {
				title : {
					type : 'outside'
				},
				overlay : {
					speedOut : 0
				}
			}
		});
		
//		$.ajax({
//			url:"json/deep.json",  
//			type:'get',
//			dataType: "json",
//			success:function(data) {
//				if(data['status']=='ERROR'){    
//					alert(data['data']);
//				}else{
//					var data=data['data'];
//					for(var key in data){
//						if(key == "samples"){ 
//							$('#sampleNames').empty();
//							var samplesArray=data["samples"].split(",");
//							for(var i=0;i<samplesArray.length;i++){
//								var name = samplesArray[i];
//								add='<li class="list-group-item ui-widget-content ui-corner-tr">'+name+'</li>'
//								$(add).appendTo('#sampleNames')
//						
//							};	
//							dragInit();
//						}else if(key == "group_samples" || key == "compare_groups" || key=="venn_compares"){  
//							if(data[key] == null || data[key] == 'null' ||data[key] == ''){
//								data[key]=[];
//							}else if(typeof(data[key])!='object'){
//								data[key]= JSON.parse(data[key]);
//							}
//							
//							if(key == "group_samples"){
//								$('#groupList').empty();
//								for(key in data["group_samples"]){
//									var value=data["group_samples"][key];
//									var html='<div name="sampleGroup" class="ui-widget-content ui-state-default sampleGroup" style=border-radius:3px;><span class="ui-widget-header" style=font-size:18px;height:28px;border:none;background:none;display:inline-block;>'+key+'</span><button style=opacity:.2; class="ui-widget-header glyphicon glyphicon-remove pull-right closeBorder" ></button><ul class="sampleNames ui-helper-reset"/></ul></div>';
//									var divHtml = $(html);
//									allgroups.push(key);
//									for(var i=0;i<value.length;i++){
//										var sample=value[i];
//										var liHtml=$('<li class="list-group-item ui-widget-content ui-corner-tr ui-draggable" style="display: block;border:none;background:none; width: 90px;">'
//									    	+sample+'</li>');
//									  liHtml.appendTo(divHtml.find("ul"))
//										
//									}
//									divHtml.appendTo('#groupList');
//									dragInit();
//								}
//							}
//						
//							if(key == "compare_groups"){
//								$('#compareList').empty();
//								for(key in data["compare_groups"]){
//									var value=data["compare_groups"][key];
//									var html='<div name="goupCompare" class="ui-widget-content ui-state-default goupCompare" style=border-radius:3px;><span class="ui-widget-header" style=font-size:18px;height:28px;border:none;background:none;display:inline-block;>'+key+'</span><button style=opacity:.2; class="ui-widget-header glyphicon glyphicon-remove pull-right closeBorder" ></button><ul class="goupCompare ui-helper-reset"/></ul></div>';
//									var divHtml = $(html);
//									allCompares.push(key);
//									for(var i=0;i<value.length;i++){
//										var sample=value[i];
//										var liHtml=$('<li class="list-group-item ui-widget-content ui-corner-tr ui-draggable" style="display: block;border:none;background:none; width: 90px;">'
//									    	+sample+'</li>');
//									  liHtml.appendTo(divHtml.find("ul"))
//										
//									}
//									divHtml.appendTo('#compareList');
//									dragInit();
//								}
//							}
//							
//							if(key == "venn_compares"){
//								$('#vennList').empty();
//								for(key in data["venn_compares"]){
//									var value=data["venn_compares"][key];
//									var html='<div name="venn" class="ui-widget-content ui-state-default venn" style=margin-left:10px;border-radius:3px;><span class="ui-widget-header" style=font-size:18px;height:28px;border:none;background:none;display:inline-block;>'+key+'</span><button style=opacity:.2; class="ui-widget-header glyphicon glyphicon-remove pull-right closeBorder" ></button><ul class="goupCompare ui-helper-reset"/></ul></div>';
//									var divHtml = $(html);
//									allVenns.push(key);
//									for(var i=0;i<value.length;i++){
//										var sample=value[i];
//										var liHtml=$('<li class="list-group-item ui-widget-content ui-corner-tr ui-draggable" style="display: block;border:none;background:none; width: 90px;">'
//									    	+sample+'</li>');
//									  liHtml.appendTo(divHtml.find("ul"))
//										
//									}
//									divHtml.appendTo('#vennList');
//									dragInit();
//								}
//							}
//								
//						}else if(key == "filterCondition"||key == "dgfPTypes"){
//							$('#'+key).selectpicker('val',data[key]);
//		
//							
//						}else{
//							$("#"+key).val(data[key]);
//						};
//					}
//				}
//			}
//		})
								
	});
		
//------按钮们--------
//刷新
	$("#refresh").click(function(){
		window.location.reload();
    });
//终止
	$("#stop").click(function(){
		var r=confirm("您确定要终止该任务吗？");
		if(r==true){
			 var id = $("#taskId").val();
			 $.ajax({
				    url:stop_url,  
				    type:'post',
				    data:{id:id},
				    dataType: "json",
				    success:function(data) {
				    	if(data['status']=='ERROR'){    //请求成功但没有执行成功
				    		alert(data['data']);
				    	}else{
							alert("任务终止成功！");	
							$(this).find("img").attr("src","img/start.svg") 
				    	};
				     },    
				     error : function(XMLHttpRequest) {
				       alert(XMLHttpRequest.status +' '+ XMLHttpRequest.statusText);    
				     }
				});  
		  };
    });    
//删除
	$("#delete").click(function(){
		var r=confirm("您确定要删除该任务吗？");
		if(r==true){

			 var id = $("#taskId").val();
			 $.ajax({
				    url:delete_url,  
				    type:'post',
				    data:{id:id},
				    dataType: "json",
				    success:function(data) {
				    	if(data['status']=='ERROR'){    //请求成功但没有执行成功
				    		alert(data['data']);
				    	}else{
							alert("删除成功！");	
				    	};
				     },    
				     error : function(XMLHttpRequest) {
				       alert(XMLHttpRequest.status +' '+ XMLHttpRequest.statusText);    
				     }
				});  
		  };
    });
/*-----------------差异倍数页面js代码------------------*/
$(function(){
	var compareData = null;
//	function updateTable(){
//		if(!compareData) return;
//		var p=$("#compareGroups").selectpicker("val");
//		for(var j=0;j<compareData.length;j++){
//			if(p==compareData[j]["compareName"]){
//				var content=compareData[j]['content'];
//				var head=content[0];
//				var options={
//					clickToSelect:true,
//					showFooter:false,
//					classes:'table',
//					columns: []
//				}
//				for(var m=0;m<head.length;m++){
//					var obj={order: "asc"};
//					obj["title"]=head[m];
//					obj["field"]=head[m];
//					options.columns.push(obj);
//				}
//				$("#dgfGeneList table").bootstrapTable(options);
//
//				var tableData=[];
//				for(var i=1;i<content.length;i++){
////					var thead=content[0];
//					var row=content[i];
//					var rowObj={};
//					for(var k=0;k<row.length;k++){
//						rowObj[head[k]]=row[k];
//					}
//					tableData.push(rowObj);
//				}
//				$("#dgfGeneList table").bootstrapTable('destroy');
//				$("#dgfGeneList table").bootstrapTable(options);
//				$("#dgfGeneList table").bootstrapTable('load',tableData);
//			}
//		}
//	}
	var geneSet;
	$('a[href="#dgfGeneList"]').on('show.bs.tab', function (e) {
		updateTable("compareGroups","dgfGeneList",compareData);
	})
	
	/*轮播图片初始化*/
    $("#dgfCarousel").jCarouselLite({
        btnNext: ".default #dgfNext",
        btnPrev: ".default #dgfPrev",
        visible: 1,
        speed: 800
    });
    function statusUpdate(){
    	$.ajax({
				url:'json/taskDetail.2.json',  
				type:'get',
				dataType: "json",
				success:function(data) {
					$('#dgfmodStatusTable').bootstrapTable('load',data["modStatus"]);
				},
				error : function(XMLHttpRequest) {
				   alert(XMLHttpRequest.status +' '+ XMLHttpRequest.statusText);    
				}
			})

    }
	/*打开任务状态不断更新数据*/
	var setInt;
	$('a[href="#dgfStatus"]').on('show.bs.tab', function (e) {
		statusUpdate();
		setInt=window.setInterval(statusUpdate,5000)
	})
	/*关闭任务状态不更新数据*/
	$('a[href="#dgfStatus"]').on('hide.bs.tab', function (e) {
		window.clearInterval(setInt)
	})
	//样本分组初始化设置
	var sampleValues = sessionStorage.getItem("samples"); 
	if(sampleValues){
		if(sampleValues.length>0){
			var samplesArray=sampleValues.split(",");
			for(var i=0;i<samplesArray.length;i++){
				var name = samplesArray[i];
				add='<li class="list-group-item ui-widget-content ui-corner-tr">'+name+'</li>'
				$(add).appendTo('#sampleNames')
		
			};	
			dragInit();
		}
	}
	
	var groupsValues = sessionStorage.getItem("groupSamples");
	var groupsObg = $.parseJSON( groupsValues ); 
	if(groupsObg){
		for(key in groupsObg){
			var value=groupsObg[key];
			var html='<div name="sampleGroup" class="ui-widget-content ui-state-default sampleGroup" style=border-radius:3px;><span class="ui-widget-header" style=font-size:18px;height:28px;border:none;background:none;display:inline-block;>'+key+'</span><button style=opacity:.2; class="ui-widget-header glyphicon glyphicon-remove pull-right closeBorder" ></button><ul class="sampleNames ui-helper-reset"/></ul></div>';
			var divHtml = $(html);
			allgroups.push(key);
			for(var i=0;i<value.length;i++){
				var sample=value[i];
				var liHtml=$('<li class="list-group-item ui-widget-content ui-corner-tr ui-draggable" style="display: block;border:none;background:none; width: 90px;">'
			    	+sample+'</li>');
			  liHtml.appendTo(divHtml.find("ul"))
				
			}
			divHtml.appendTo('#groupList');
			dragInit();
		}
	}
	
	var compareValues = sessionStorage.getItem("compareGroups");
	var compareObg = $.parseJSON( compareValues ); 
	if(compareObg){
		for(key in compareObg){
			var value=compareObg[key];
			var html='<div name="goupCompare" class="ui-widget-content ui-state-default goupCompare" style=border-radius:3px;><span class="ui-widget-header" style=font-size:18px;height:28px;border:none;background:none;display:inline-block;>'+key+'</span><button style=opacity:.2; class="ui-widget-header glyphicon glyphicon-remove pull-right closeBorder" ></button><ul class="goupCompare ui-helper-reset"/></ul></div>';
			var divHtml = $(html);
			allCompares.push(key);
			for(var i=0;i<value.length;i++){
				var sample=value[i];
				var liHtml=$('<li class="list-group-item ui-widget-content ui-corner-tr ui-draggable" style="display: block;border:none;background:none; width: 90px;">'
			    	+sample+'</li>');
			  liHtml.appendTo(divHtml.find("ul"))
				
			}
			divHtml.appendTo('#compareList');
			dragInit();
		}
	}
	
	
	var vennValues = sessionStorage.getItem("vennCompares"); 
	var vennObg = $.parseJSON( vennValues ); 
	if(vennObg){
		for(key in vennObg){
			var value=vennObg[key];
			var html='<div name="venn" class="ui-widget-content ui-state-default venn" style=margin-left:10px;border-radius:3px;><span class="ui-widget-header" style=font-size:18px;height:28px;border:none;background:none;display:inline-block;>'+key+'</span><button style=opacity:.2; class="ui-widget-header glyphicon glyphicon-remove pull-right closeBorder" ></button><ul class="goupCompare ui-helper-reset"/></ul></div>';
			var divHtml = $(html);
			allVenns.push(key);
			for(var i=0;i<value.length;i++){
				var sample=value[i];
				var liHtml=$('<li class="list-group-item ui-widget-content ui-corner-tr ui-draggable" style="display: block;border:none;background:none; width: 90px;">'
			    	+sample+'</li>');
			  liHtml.appendTo(divHtml.find("ul"))
				
			}
			divHtml.appendTo('#vennList');
			dragInit();
		}
	}
	
	$("#groupName").keydown(function(k){
		if(k.keyCode==13 ){
			addGroup();
		}
	});
	$("#addGroup").click(function(){
		addGroup();
	});
	$("#compareName").keydown(function(k){
		if(k.keyCode==13 ){
			addCompare();
		}
	});
	$("#addCompare").click(function(){
		addCompare();
	});
	$("#addVenn").click(function(){
		addVenn();
	});
	var dirPathValue = window.sessionStorage.getItem("dir_path"); 
	if(dirPathValue){
		if(dirPathValue.length>0){
			$("#dfgInputPath").val(dirPathValue);
			window.sessionStorage.setItem("dfgInputPath",$("#dfgInputPath").val());
		}
	}
	
	//var parasValue = sessionStorage.getItem("paras"); 
	//var parasObj = $.parseJSON( parasValue );
	//if(parasObj){
	//	var inputPath=parasObj.taskPara[4].value;
	//	$("#dfgInputPath").val(inputPath)
	//	window.sessionStorage.setItem("dfgInputPath",$("#dfgInputPath").val());
	//}
	//提交参数
	$("#dgfSubmit_paras").click(function(){
		var formData =  allParams($("#dgfParameter"));//取form表单参数
		if(formData.dgfInput==""){
			alert("请选择输出目录！");
		}else{
			if($("#dgfPValue").val()<0||$("#dgfPValue").val()>1){
				alert("p值大小必须大于等于0小于等于1！")
			}
			if($("#diffMultiple").val()<0){
				alert("差异倍数必须大于等于0！")
			}
			var groupCompareVenn={};	//发向服务器的json数据
			//检查是否有分组，每个分组下的样品名
			var groups =$('#groupList').find('div');
			var allGroupItems=[];
			if(groups.length>0){
				var groupSamples= {};
				for(var i=0; i<groups.length; i++){
					var sampleItems = $($(groups[i]).find('ul')[0]).find('li');
					if(sampleItems.length==0){
						continue;
					}			
					//组名
					var curGroup =$($(groups[i]).find('span')).text().replace(/(^\s*)|(\s*$)/g, "");  //空格开头或者结尾
					var curGroupSamples = new Array();
					for(var j=0; j < sampleItems.length ;j++){
						curGroupSamples.push($(sampleItems[j]).text().replace(/(^\s*)|(\s*$)/g, ""));
					}
					allGroupItems.push(curGroupSamples[0]);
					groupSamples[curGroup]= curGroupSamples;
				}
				groupCompareVenn['groupSamples']= groupSamples;
			}
		//检查数据
		//检查样本是否已全部分组，非强制
		var samples=$("#sampleNames").find('li');
		if(samples.length>0){
			for(var i=0;i<samples.length;i++){
				if(allGroupItems.indexOf(samples[i].innerText)==-1){
					if(!confirm("发现有未分组的样品，确定不分组?")){
						return false;
					}
				}
			}
		}

		//检查比较组
		var compares = $('#compareList').find('div');
		if(compares.length>0){
			var compareGroups = {};
			for(var i=0; i<compares.length; i++){
				var groupItems = $($(compares[i]).find('ul')[0]).find('li');
				if(groupItems.length==0){
					continue;
				}
				//比较组名
				var curCompare = $($(compares[i]).find('span')).text().replace(/(^\s*)|(\s*$)/g, "");
				var curCompareGroups = new Array();
				for(var j=0; j<groupItems.length; j++){
					curCompareGroups.push($(groupItems[j]).text().replace(/(^\s*)|(\s*$)/g, ""));
				}
				compareGroups[curCompare] = curCompareGroups;
			}
			groupCompareVenn['compareGroups']= compareGroups;
		}
		//检查venn图
		var venns = $('#vennList').find('div');
		if(venns.length>0){
			var vennCompares={};
			for(var i=0; i<venns.length; i++){
				var compareItems = $($(venns[i]).find('ul')[0]).find('li');
				if(compareItems.length==0){
					continue;
				}
				
				//比较韦恩图
				var curVennCompares = $($(venns[i]).find('span')).text().replace(/(^\s*)|(\s*$)/g, "");
				var curVennGroups = new Array();
				for(var j=0; j<compareItems.length; j++){
					curVennGroups.push($(compareItems[j]).text().replace(/(^\s*)|(\s*$)/g, ""));
				}
				vennCompares[curVennCompares] = curVennGroups;
			}
			groupCompareVenn['vennCompares'] = vennCompares;
		}
		//全部的参数	
		var samplesStr=""
		for(var j=0;j<samples.length;j++ ){  
			if(samplesStr == ""){
				samplesStr += samples[j].innerText;
				}
			else{
				samplesStr += ","+samples[j].innerText;
				}
		};

		var resultPara={
						"paras":formData,
						"samples":samplesStr,
						"groupCompareVenn":groupCompareVenn
						}; 
		
		resultPara = JSON.stringify(resultPara);
		console.log(resultPara)
			$.ajax({
				url: 'json/taskDetail.2.json',  
				type:'get',
				data:{parameter:resultPara},
				dataType: "json",
				success:function(data) {	
					var showData=data["show"];
					compareData=data["arr"];
					$("#dgfCarousel").empty();
					$("#dgfCarousel").append("<ul></ul>");
 					for(var i=0;i<showData.length;i++){
 						$("#dgfCarousel").find("ul").append("<li style='width: 455px;height: 460px;' ><a class='fancybox-effects-a' href='"+showData[i]+"' title='Lorem'><img style='width: 455px;height:460px;padding-right: 23px;' src='" + showData[i] +"' alt='' /></a></li>")
 					}
     				$("#dgfCarousel").jCarouselLite({
				        btnNext: ".default #dgfNext",
				        btnPrev: ".default #dgfPrev",
				        visible: 1,
				        speed: 800
				    });
				    $("#compareGroups").empty()
					for(var i=0;i<compareData.length;i++){
						var option="<option value="+compareData[i]["compareName"]+">"+compareData[i]["compareName"]+"</option>"
						$("#compareGroups").append(option);
					}
					$('#compareGroups').selectpicker('refresh');
					$('#compareGroups').on('changed.bs.select', function (e) {
						updateTable("compareGroups","dgfGeneList",compareData);
					});
					window.sessionStorage.setItem("pGeneInput",$("#dgfInput").val());						
							
				},    
				error : function(XMLHttpRequest) {
					alert(XMLHttpRequest.status +' '+ XMLHttpRequest.statusText);
				}
			});
		}
	});
});

//初始化拖拽
function dragInit() {
	var $sampleNames = $( "#sampleNames" ),
    		$sampleGroup = $( ".sampleGroup" ),
    		$compareGroup = $(".goupCompare")
    		$venn = $(".venn");
	//样本拖动
	$( "li", $sampleNames ).draggable({
	      cancel: "a.ui-icon", // 点击一个图标不会启动拖拽
	      revert: "invalid", // 当未被放置时，条目会还原回它的初始位置
	      containment: "document",
	      helper: "clone",
	      cursor: "move"
	    });
	//分组拖动
	$( ".sampleGroup" ).draggable({
	    revert: "invalid", 
	    containment: "document",
	    helper: "clone",
	    cursor: "move"
	});
	
	//比较组拖动
	$(".goupCompare").draggable({
	      revert: "invalid", 
	      containment: "document",
	      helper: "clone",
	      cursor: "move"
	    });
	//维恩图接收比较组名
	$venn.droppable({
	      accept: "#compareList>div",
	      activeClass: "ui-state-highlight",
	      tolerance:"pointer",
	      drop: function( event, ui ) {
	        dropItem( ui.draggable ,$(this),'#333', 5);
	      }
	    });
	//比较组接收组名
	$compareGroup.droppable({
	      accept: ".sampleGroup",
	      activeClass: "ui-state-highlight",
	      tolerance:"pointer",
	      drop: function( event, ui ) {
	        dropItem( ui.draggable ,$(this),'#333',2);
	      }
	    });
	//分组接收样本
	var maxNum=$("#sampleNames li").length
	$sampleGroup.droppable({
	      accept: "#sampleNames > li, .sampleGroup li",
	      activeClass: "ui-state-highlight",
	      tolerance:"pointer",
	      drop: function( event, ui ) {
	        dropItem( ui.draggable ,$(this),'#333',maxNum);
	      }
	    });
	 if(maxNum>12){
	 	$("#sampleNames").css({
	 		height:'360px',
	 		overflow:'auto'
	 	})
	 }
	if($("#groupList .sampleGroup").length>12){
		$("#groupList").css({
	 		height:'360px',
	 		overflow:'auto'
	 	})
	}

	    curcontainer= null;
	    function dropItem($item ,$container,$color,maxNum){
	    	if($item.context.localName=='li'){
	    		var itemName = $item.text();
	    		var items = $container.find('li');
		    	if(items.length>=maxNum){
		    		alert("超出了最大允许数目"+maxNum);
		    		return false;
		    	}
		    	for (var i=0; i<items.length; i++){
		    		if($(items[i]).text()==itemName){
		    			alert("有重复的条目"+itemName+"！");
		    			return false;
		    		}
		    	}
	    		var $list = $( "ul", $container ).length ?$( "ul", $container ) :$( "<ul class='sampleNames ui-helper-reset'/>" ).appendTo($container);
			    $('<li class="list-group-item ui-widget-content ui-corner-tr ui-draggable" style="display: block;border:none;background:none; width: 90px;color:'+$color+'">'
		    	+itemName+'</li>').appendTo($list).fadeIn(function() {
		  	            $item
			              	.find( "img" )
			                .animate({ height: "36px" });
			          	});
			        
	    	}else{
	    		var itemName = $item.children("span").text();
		    	//遍历container查看已包含哪些元素
		    	var containItems= new Array();
		    	var items = $container.find('li');
		    	if(items.length>=maxNum){
		    		alert("超出了最大允许数目"+maxNum);
		    		return false;
		    	}
		    	for (var i=0; i<items.length; i++){
		    		if($(items[i]).text()==itemName){
		    			alert("有重复的条目"+itemName+"！");
		    			return false;
		    		}
		    	}
		    	
		    	var $list = $( "ul", $container ).length ?
			            $( "ul", $container ) :
			            $( "<ul class='goupCompare ui-helper-reset'/>" ).appendTo($container);
			    $('<li class="list-group-item ui-widget-content ui-corner-tr ui-draggable" style="display: block;border:none;background:none; width: 90px;color:'+$color+'">'
			    	+itemName+'</li>').appendTo($list).fadeIn(function() {
			            $item
			              .find( "img" )
			                .animate({ height: "36px" });
			         });
		    		
	    	}
	    }
	    
	    function recycleItem( $item ) {
	      $item.fadeOut(function() {
	        $item
	          .find( "a.ui-icon-refresh" )
	            .remove()
	          .end()
	          .css("background-color","#FFFFFF").css("border","1px solid #dddddd")
	          .find( "img" )
	            .css( "height", "72px" )
	          .end()
	          .appendTo( $sampleNames )
	          .fadeIn();
	      });
	    }
	    
	    $("#groupList .glyphicon-remove").each(function(){
			$(this).click(function(){
				$(this).parent('div').remove();
				var value=$(this).siblings("span").text();
				var index=$.inArray(value,allgroups);
				
				if(index==-1){
					return ;
				}
				allgroups.splice(index,1);
				
				$("#compareList").find("li").each(function(){
					if($(this).text()==value){
						$(this).remove();
					}
					
				})

				dragInit();
			})
		});
		$("#compareList .glyphicon-remove").each(function(){
			$(this).click(function(){
				$(this).parent('div').remove();
				var value=$(this).siblings("span").text();
				var index=$.inArray(value,allCompares);
				if(index==-1){
					return ;
				}
				
				$("#vennList").find("li").each(function(){
					if($(this).text()==value){
						$(this).remove();
					}
					
				})
				allCompares.splice(index,1);
			})
		});
		$("#vennList .glyphicon-remove").each(function(){
			$(this).click(function(){
				var value=$(this).siblings("span").text();
				var index=$.inArray(value,allVenns);
				if(index==-1){
					return ;
				}
				allVenns.splice(index,1);
				$(this).parent('div').remove();
			})
		});
};

var patrn=/^(\w){1,10}$/i; 
var allgroups = new Array();	//all groups
function addGroup(){
	var gname= $("#groupName").val();
	if(gname=='' ||gname==null){
		return false;
	}
    if (!patrn.exec(gname)) {
    	alert('只能包含字母数字下划线，长度不超过10');
		return false;
	}
	if(-1!=allgroups.indexOf(gname,0)){
		alert('分组名'+gname+"已存在！");
		return false;
	}
	if($('#sampleNames>li').length<=allgroups.length){
		alert("分组数不能超过样本数！");
		return false;
	}
	$("#groupName").val('');
	var html='<div name="sampleGroup" class="ui-widget-content ui-state-default sampleGroup" style=border-radius:3px;><span class="ui-widget-header" style=font-size:18px;height:28px;border:none;background:none;display:inline-block;>'+gname+'</span><button style=opacity:.2; class="ui-widget-header glyphicon glyphicon-remove pull-right closeBorder" ></button></div>';
	$(html).appendTo('#groupList');
	allgroups.push(gname);
	dragInit();
}

//增加比较组
var allCompares = new Array(); 
function addCompare(){
	if(allgroups.length <2){
		alert('此为组间比较，至少需要两个样本组，请先填写样本组信息！');
		return false;
	}

	var cname= $('#compareName').val();
	if (!patrn.exec(cname)) {
    	alert('只能包含字母数字下划线，长度不超过10');
		return false;
	}
	if(cname=='' ||cname==null){
		return false;
	}
	if(-1!=allCompares.indexOf(cname,0)){
		alert('比较组'+cname+"已存在！");
		return false;
	}
	$('#compareName').val('');
	var html='<div name="goupCompare" class="ui-widget-content ui-state-default goupCompare" style=border-radius:3px;><span class="ui-widget-header" style="font-size:18px;border:none;background:none;height:28px;display:inline-block;" >'+cname+'</span><button style=opacity:.2; class="ui-widget-header glyphicon glyphicon-remove pull-right closeBorder" ></button></div>';
	$(html).appendTo('#compareList');
	allCompares.push(cname);
	dragInit();
}
var allVenns = new Array(); 
function addVenn(){
	if(allCompares.length <2){
		alert("维恩图至少需要两个比较组，请先填写比较组信息！");
		return false;
	}
	var cname= $('#vennName').val();
	if (!patrn.exec(cname)) {
    	alert('只能包含字母数字下划线，长度不超过10');
		return false;
	}
	if(cname=='' ||cname==null){
		return false;
	}
	if(-1!=allVenns.indexOf(cname,0)){
		alert('维恩组'+cname+"已存在！");
		return false;
	}
	$('#vennName').val('');
	var html='<div name="venn" class="ui-widget-content ui-state-default venn" style=margin-left:10px;border-radius:3px;><span class="ui-widget-header" style="font-size:18px;border:none;background:none;height:28px;display:inline-block;" >'+cname+'</span><button style=opacity:.2; class="ui-widget-header glyphicon glyphicon-remove pull-right closeBorder" ></button></div>';

	$(html).appendTo('#vennList');
	allVenns.push(cname);
	dragInit();
}

/*-----------------差异基因富集注释js代码------------------*/
$(function(){
	//右侧选项卡滚动初始化
	$("#carousel0").jCarouselLite({
        btnNext: ".default .next1",
        btnPrev: ".default .prev1",
        visible: 3,
        speed: 800
    });
    //GO富集柱状图滚动图片初始化       
    $("#EAGOBarCarousel").jCarouselLite({
        btnNext: ".default #EAGOBarNext",
        btnPrev: ".default #EAGOBarPrev",
        visible: 1,
        speed: 800
    });
    //GO富集DAG图滚动图片初始化
    $("#EAGODagCarousel").jCarouselLite({
        btnNext: ".default #EAGODagNext",
        btnPrev: ".default #EAGODagPrev",
        visible: 1,
        speed: 800
    });
    //KEGG散点图滚动图片初始化
    $("#EAKEGGScatterCarousel").jCarouselLite({
        btnNext: ".default #EAKEGGScatterNext",
        btnPrev: ".default #EAKEGGScatterPrev",
        visible: 1,
        speed: 800
    });

	var keggValue=defaultRefParams["KEGG"][0]["value"];
	var value = keggValue.split(";")
	var opts = ""
	console.log(value)
	for(var j = 0; j < value.length; j++) {
		var tmpArr = value[j].split(',');
		if(tmpArr.length < 2) {
			tmpArr[1] = tmpArr[0];
		}
		opts += '<option value="' + tmpArr[0] + '">' + tmpArr[1] + '</option>'; //给option添加一个value
	};
	//添加dropdown的代码
	$("#ogKeggAbb").append(opts);
	$("#pgKeggAbb").append(opts);
    function statusUpdate(){
    	$.ajax({
				url:'json/taskDetail.2.json',  
				type:'get',
				dataType: "json",
				success:function(data) {
					$('#EAStatus table').bootstrapTable('load',data["modStatus"]);
				},
				error : function(XMLHttpRequest) {
				   alert(XMLHttpRequest.status +' '+ XMLHttpRequest.statusText);    
				}
			})

    }
	/*打开任务状态不断更新数据*/
	var eaSet;
	$('a[href="#EAStatus"]').on('show.bs.tab', function (e) {
		statusUpdate();
		eaSet=window.setInterval(statusUpdate,5000)
	})
	/*关闭任务状态不更新数据*/
	$('a[href="#EAStatus"]').on('hide.bs.tab', function (e) {
		window.clearInterval(eaSet)
	})
    
    /*使用原始基因*/
   	var compareData1 = null;
   	var compareData2 = null;
	$('a[href="#EAKEGGList"]').on('show.bs.tab', function (e) {
		updateTable("EAKEGGListCompareGroups","EAKEGGList",compareData1);
	})
	$('a[href="#EAGOList"]').on('show.bs.tab', function (e) {
		updateTable("EAGOListCompareGroups","EAGOList",compareData2);
	})
	var dirPathValue = sessionStorage.getItem("dir_path"); 
	if(dirPathValue){
		if(dirPathValue.length>0){
			$("#oGeneInput").val(dirPathValue)
		}
	}
	//提交参数
	$("#eaoSubmit_paras").click(function(){
		var formData =  allParams($("#originalGeneParameter"));//取form表单参数
		if(formData.ogInput==""){
			alert("请选择输出目录！");
		}else{
			if($("#ogpValue").val()<0||$("#ogpValue").val()>1){
				alert("p值大小必须大于等于0小于等于1！")
			}
			if($("#ogEValue").val()<0){
				alert("差异倍数必须大于等于0！")
			}
		
		var resultPara={"paras":formData}; 		
		resultPara = JSON.stringify(resultPara);
		console.log(resultPara)
			$.ajax({
				url: 'json/deepExcavation1.json',  
				type:'get',
				data:{parameter:resultPara},
				dataType: "json",
				success:function(data) {
					//kegg散点图
					var KEGGScatter=data["KEGGScatter"];
					$("#EAKEGGScatterCarousel").empty();
					$("#EAKEGGScatterCarousel").append("<ul></ul>");
 					for(var i=0;i<KEGGScatter.length;i++){
 						$("#EAKEGGScatterCarousel").find("ul").append("<li style='width: 455px;height: 460px;' ><a class='fancybox-effects-a' href='"+KEGGScatter[i]+"' title='Lorem'><img style='width: 455px;height:460px;padding-right: 23px;' src='" + KEGGScatter[i] +"' alt='' /></a></li>")
 					}
     				$("#EAKEGGScatterCarousel").jCarouselLite({
				        btnNext: ".default #EAKEGGScatterNext",
				        btnPrev: ".default EAKEGGScatterPrev",
				        visible: 1,
				        speed: 800
				    });
				    //go富集柱状图
				    var GoBar=data["GoBar"];
					$("#EAGOBarCarousel").empty();
					$("#EAGOBarCarousel").append("<ul></ul>");
 					for(var i=0;i<GoBar.length;i++){
 						$("#EAGOBarCarousel").find("ul").append("<li style='width: 455px;height: 460px;' ><a class='fancybox-effects-a' href='"+GoBar[i]+"' title='Lorem'><img style='width: 455px;height:460px;padding-right: 23px;' src='" + GoBar[i] +"' alt='' /></a></li>")
 					}
     				$("#EAGOBarCarousel").jCarouselLite({
				        btnNext: ".default #EAGOBarNext",
				        btnPrev: ".default #EAGOBarPrev",
				        visible: 1,
				        speed: 800
				    });
				    //go富集DAG图
				    var GoDag=data["GoDag"];
					$("#EAGODagCarousel").empty();
					$("#EAGODagCarousel").append("<ul></ul>");
 					for(var i=0;i<GoBar.length;i++){
 						$("#EAGODagCarousel").find("ul").append("<li style='width: 455px;height: 460px;' ><a class='fancybox-effects-a' href='"+GoDag[i]+"' title='Lorem'><img style='width: 455px;height:460px;padding-right: 23px;' src='" + GoDag[i] +"' alt='' /></a></li>")
 					}
     				$("#EAGODagCarousel").jCarouselLite({
				        btnNext: ".default #EAGODagNext",
				        btnPrev: ".default #EAGODagPrev",
				        visible: 1,
				        speed: 800
				    });
				    
				    compareData1=data["KEGGList"];
				     $("#EAKEGGListCompareGroups").empty();
					for(var i=0;i<compareData1.length;i++){
						var option="<option value="+compareData1[i]["compareName"]+">"+compareData1[i]["compareName"]+"</option>"
						$("#EAKEGGListCompareGroups").append(option);
					}
					$('#EAKEGGListCompareGroups').selectpicker('refresh');
					$('#EAKEGGListCompareGroups').on('changed.bs.select', function (e) {
						updateTable("EAKEGGListCompareGroups","EAKEGGList",compareData1);
					});
					
					compareData2=data["GoList"];
					$("#EAGOListCompareGroups").empty();
					for(var i=0;i<compareData2.length;i++){
						var option="<option value="+compareData2[i]["compareName"]+">"+compareData2[i]["compareName"]+"</option>"
						$("#EAGOListCompareGroups").append(option);
					}
					$('#EAGOListCompareGroups').selectpicker('refresh');
					$('#EAGOListCompareGroups').on('changed.bs.select', function (e) {
						updateTable("EAGOListCompareGroups","EAGOList",compareData2);
					});
				},    
				error : function(XMLHttpRequest) {
					alert(XMLHttpRequest.status +' '+ XMLHttpRequest.statusText);
				}
			});
		}
	});
	
	/*使用上一步基因*/
	//提交参数
	$("#eapSubmit_paras").click(function(){
		var pgInputValue = sessionStorage.getItem("pGeneInput"); 
		$("#pGeneInput").val(pgInputValue)
		window.sessionStorage.setItem("pgInput",$("#pgInput").val());
		var formData =  allParams($("#previousGeneParameter"));//取form表单参数
		if(formData.pgInput==""){
			alert("请选择输出目录！");
		}else{
			if($("#pgpValue").val()<0||$("#ogpValue").val()>1){
				alert("p值大小必须大于等于0小于等于1！")
			}
			if($("#pgEValue").val()<0){
				alert("差异倍数必须大于等于0！")
			}
		
		var resultPara={"paras":formData}; 		
		resultPara = JSON.stringify(resultPara);
		console.log(resultPara)
			$.ajax({
				url: 'json/deepExcavation2.json',  
				type:'get',
				data:{parameter:resultPara},
				dataType: "json",
				success:function(data) {
					//kegg散点图
					var KEGGScatter=data["KEGGScatter"];
					$("#EAKEGGScatterCarousel").empty();
					$("#EAKEGGScatterCarousel").append("<ul></ul>");
 					for(var i=0;i<KEGGScatter.length;i++){
 						$("#EAKEGGScatterCarousel").find("ul").append("<li style='width: 455px;height: 460px;' ><a class='fancybox-effects-a' href='"+KEGGScatter[i]+"' title='Lorem'><img style='width: 455px;height:460px;padding-right: 23px;' src='" + KEGGScatter[i] +"' alt='' /></a></li>")
 					}
     				$("#EAKEGGScatterCarousel").jCarouselLite({
				        btnNext: ".default #EAKEGGScatterNext",
				        btnPrev: ".default EAKEGGScatterPrev",
				        visible: 1,
				        speed: 800
				    });
				    //go富集柱状图
				    var GoBar=data["GoBar"];
					$("#EAGOBarCarousel").empty();
					$("#EAGOBarCarousel").append("<ul></ul>");
 					for(var i=0;i<GoBar.length;i++){
 						$("#EAGOBarCarousel").find("ul").append("<li style='width: 455px;height: 460px;' ><a class='fancybox-effects-a' href='"+GoBar[i]+"' title='Lorem'><img style='width: 455px;height:460px;padding-right: 23px;' src='" + GoBar[i] +"' alt='' /></a></li>")
 					}
     				$("#EAGOBarCarousel").jCarouselLite({
				        btnNext: ".default #EAGOBarNext",
				        btnPrev: ".default #EAGOBarPrev",
				        visible: 1,
				        speed: 800
				    });
				    //go富集DAG图
				    var GoDag=data["GoDag"];
					$("#EAGODagCarousel").empty();
					$("#EAGODagCarousel").append("<ul></ul>");
 					for(var i=0;i<GoBar.length;i++){
 						$("#EAGODagCarousel").find("ul").append("<li style='width: 455px;height: 460px;' ><a class='fancybox-effects-a' href='"+GoDag[i]+"' title='Lorem'><img style='width: 455px;height:460px;padding-right: 23px;' src='" + GoDag[i] +"' alt='' /></a></li>")
 					}
     				$("#EAGODagCarousel").jCarouselLite({
				        btnNext: ".default #EAGODagNext",
				        btnPrev: ".default #EAGODagPrev",
				        visible: 1,
				        speed: 800
				    });
				    compareData1=data["KEGGList"];
				    $("#EAKEGGListCompareGroups").empty();
					for(var i=0;i<compareData1.length;i++){
						var option="<option value="+compareData1[i]["compareName"]+">"+compareData1[i]["compareName"]+"</option>"
						$("#EAKEGGListCompareGroups").append(option);
					}
					$('#EAKEGGListCompareGroups').selectpicker('refresh');
					$('#EAKEGGListCompareGroups').on('changed.bs.select', function (e) {
						updateTable("EAKEGGListCompareGroups","EAKEGGList",compareData1);
					});
					
					compareData2=data["GoList"];
					$("#EAGOListCompareGroups").empty();
					for(var i=0;i<compareData2.length;i++){
						var option="<option value="+compareData2[i]["compareName"]+">"+compareData2[i]["compareName"]+"</option>"
						$("#EAGOListCompareGroups").append(option);
					}
					$('#EAGOListCompareGroups').selectpicker('refresh');
					$('#EAGOListCompareGroups').on('changed.bs.select', function (e) {
						updateTable("EAGOListCompareGroups","EAGOList",compareData2);
					});
				},    
				error : function(XMLHttpRequest) {
					alert(XMLHttpRequest.status +' '+ XMLHttpRequest.statusText);
				}
			});
		}
	});
	
	
})
/*-----------------KEGG通路散点图js代码------------------*/
$(function(){
    $("#KEGGScatterCarousel").jCarouselLite({
        btnNext: ".default #KEGGScatterNext",
        btnPrev: ".default #KEGGScatterPrev",
        visible: 1,
        speed: 800
    });
	
    function statusUpdate(){
    	$.ajax({
			url:'json/taskDetail.2.json',  
			type:'get',
			dataType: "json",
			success:function(data) {
				$('#KEGGStatus table').bootstrapTable('load',data["modStatus"]);
			},
			error : function(XMLHttpRequest) {
			   alert(XMLHttpRequest.status +' '+ XMLHttpRequest.statusText);    
			}
		})

    }
	/*打开任务状态不断更新数据*/
	var keggSet;
	$('a[href="#KEGGStatus"]').on('show.bs.tab', function (e) {
		statusUpdate();
		keggSet=window.setInterval(statusUpdate,5000)
	})
	/*关闭任务状态不更新数据*/
	$('a[href="#KEGGStatus"]').on('hide.bs.tab', function (e) {
		window.clearInterval(keggSet)
	})
	var compareData5=null;
	$('a[href="#KEGGPathScatter"]').on('show.bs.tab', function (e) {
		$.ajax({
				url:'json/compares.json',  
				type:'get',
				dataType: "json",
				success:function(data) {
					debugger
					var compares=data["compareName"];
					if(compares.length>0){
						for(var i=0;i<compares.length;i++){
							var option="<option value="+compares[i]+">"+compares[i]+"</option>";
							$("#oriKeggCompareGroups").append(option);
						}
						$('#oriKeggCompareGroups').selectpicker('refresh');
					}
				},
				error : function(XMLHttpRequest) {
				   alert(XMLHttpRequest.status +' '+ XMLHttpRequest.statusText);    
				}
		})
	})
	$('a[href="#KEGGPathScatter"]').on('shown.bs.tab', function (e) {
		var groupValue=$('#oriKeggCompareGroups').val();
		console.log(groupValue)
		if(groupValue!=null){
			var allValue=$("#oriKeggAll").val();
			var resultPara={
						"compareGroups":groupValue,
						"allValue":allValue
						}; 
						
			resultPara = JSON.stringify(resultPara);
			$.ajax({
				url:'json/deep3.json',  
				type:'get',
				data:{parameter:resultPara},
				dataType: "json",
				success:function(data) {
					compareData5=data["list"];
					console.log(compareData5)
					updateCheckTable("oriKeggCompareGroups","orgKeggTable",compareData5);
					$('#oriKeggCompareGroups').on('changed.bs.select', function (e) {
						updateCheckTable("oriKeggCompareGroups","orgKeggTable",compareData5);
					});
				},
				error : function(XMLHttpRequest) {
				   alert(XMLHttpRequest.status +' '+ XMLHttpRequest.statusText);    
				}
			})
		}
	})
		
	/*使用原始KEGG*/
	var compareData4=null;
	$('a[href="#originalKEGGScatter"]').on('show.bs.tab', function (e) {
		$.ajax({
				url:'json/compares.json',  
				type:'get',
				dataType: "json",
				success:function(data) {
					var compares=data["compareName"];
					if(compares.length>0){
						for(var i=0;i<compares.length;i++){
							var option="<option value="+compares[i]+">"+compares[i]+"</option>";
							$("#oriKeggCompareGroups").append(option);
						}
						$('#oriKeggCompareGroups').selectpicker('refresh');
					}
				},
				error : function(XMLHttpRequest) {
				   alert(XMLHttpRequest.status +' '+ XMLHttpRequest.statusText);    
				}
		})
		var groupValue=$("#oriKeggCompareGroups").val();
		if(groupValue!=null){
			var allValue=$("#oriKeggAll").val();
			var resultPara={
						"compareGroups":groupValue,
						"allValue":allValue
						}; 
						
			resultPara = JSON.stringify(resultPara);
			$.ajax({
				url:'json/deep3.json',  
				type:'get',
				data:{parameter:resultPara},
				dataType: "json",
				success:function(data) {
					compareData4=data["list"];
					updateCheckTable("oriKeggCompareGroups","orgKeggTable",compareData4);
					$('#oriKeggCompareGroups').on('changed.bs.select', function (e) {
						updateCheckTable("oriKeggCompareGroups","orgKeggTable",compareData4);
					});
				},
				error : function(XMLHttpRequest) {
				   alert(XMLHttpRequest.status +' '+ XMLHttpRequest.statusText);    
				}
			})
		
		}
	})
	var arr=[]
	$("#orgKeggTable").on("check.bs.table",function(){
		var data=$(this).bootstrapTable("getSelections");
		arr.push(data)
	})
	var dirPathValue = sessionStorage.getItem("dir_path"); 
	if(dirPathValue){
		if(dirPathValue.length>0){
			$("#oriKeggInpputPath").val(dirPathValue)
		}
	}
	//提交参数
	$("#kpsoSubmit_paras").click(function(){
		var formData =  allParams($("#orgKeggParameter"));//取form表单参数
		if(formData.oKeggScaInput==""){
			alert("请选择输出目录！");
		}else{
			var tableDatas=$("#orgKeggTable").bootstrapTable("getSelections");
			var resultPara={"paras":formData,
							"tableDatas":tableDatas
							};
			resultPara = JSON.stringify(resultPara);
			$.ajax({
				url: 'json/deepExcavation1.json',  
				type:'get',
				data:{parameter:resultPara},
				dataType: "json",
				success:function(data) {
					//kegg散点图
					var oKeggPathScatter=data["KEGGScatter"];
					$("#KEGGScatterCarousel").empty();
					$("#KEGGScatterCarousel").append("<ul></ul>");
 					for(var i=0;i<oKeggPathScatter.length;i++){
 						$("#KEGGScatterCarousel").find("ul").append("<li style='width: 455px;height: 460px;' ><a class='fancybox-effects-a' href='"+oKeggPathScatter[i]+"' title='Lorem'><img style='width: 455px;height:460px;padding-right: 23px;' src='" + oKeggPathScatter[i] +"' alt='' /></a></li>")
 					}
     				$("#KEGGScatterCarousel").jCarouselLite({
				        btnNext: ".default #KEGGScatterNext",
				        btnPrev: ".default #KEGGScatterPrev",
				        visible: 1,
				        speed: 800
				    });
				},    
				error : function(XMLHttpRequest) {
					alert(XMLHttpRequest.status +' '+ XMLHttpRequest.statusText);
				}
			});
		}
	})
	
	/*使用上一步KEGG*/
	var compareData3=null;
	$('a[href="#previousKEGGScatter"]').on('show.bs.tab', function (e) {
		$.ajax({
				url:'json/compares1.json',  
				type:'get',
				dataType: "json",
				success:function(data) {
					var compares=data["compareName"];
					if(compares.length>0){
						for(var i=0;i<compares.length;i++){
							var option="<option value="+compares[i]+">"+compares[i]+"</option>";
							$("#preKeggCompareGroups").append(option);
						}
						$('#preKeggCompareGroups').selectpicker('refresh');
					}
				},
				error : function(XMLHttpRequest) {
				   alert(XMLHttpRequest.status +' '+ XMLHttpRequest.statusText);    
				}
		})
		var groupValue=$("#preKeggCompareGroups").val();
		alert(groupValue)
		if(groupValue!=null){
			var allValue=$("#preKeggAll").val();
			var resultPara={
						"compareGroups":groupValue,
						"allValue":allValue
						}; 
						
			resultPara = JSON.stringify(resultPara);
			$.ajax({
				url:'json/deep3.json',  
				type:'get',
				data:{parameter:resultPara},
				dataType: "json",
				success:function(data) {
					compareData3=data["list"];
					updateCheckTable("preKeggCompareGroups","preKeggTable",compareData3);
					$('#preKeggCompareGroups').on('changed.bs.select', function (e) {
						updateCheckTable("preKeggCompareGroups","preKeggTable",compareData3);
					});
				},
				error : function(XMLHttpRequest) {
				   alert(XMLHttpRequest.status +' '+ XMLHttpRequest.statusText);    
				}
			})
		}
	})
	//提交参数
	$("#kpspSubmit_paras").click(function(){
		var pkeggInputValue = sessionStorage.getItem("pgInput"); 
		$("#preKeggInpputPath").val(pkeggInputValue)
		var formData =  allParams($("#preKeggScaParameter"));//取form表单参数
		if(formData.pKeggScaInput==""){
			alert("请选择输出目录！");
		}else{
			var tableDatas=$("#preKeggTable").bootstrapTable("getSelections");
			var resultPara={"paras":formData,
							"tableDatas":tableDatas
							}; 		
			resultPara = JSON.stringify(resultPara);
			console.log(resultPara)
			$.ajax({
				url: 'json/deepExcavation2.json',  
				type:'get',
				data:{parameter:resultPara},
				dataType: "json",
				success:function(data) {
					//kegg散点图
					var pKeggPathScatter=data["KEGGScatter"];
					$("#KEGGScatterCarousel").empty();
					$("#KEGGScatterCarousel").append("<ul></ul>");
 					for(var i=0;i<pKeggPathScatter.length;i++){
 						$("#KEGGScatterCarousel").find("ul").append("<li style='width: 455px;height: 460px;' ><a class='fancybox-effects-a' href='"+pKeggPathScatter[i]+"' title='Lorem'><img style='width: 455px;height:460px;padding-right: 23px;' src='" + pKeggPathScatter[i] +"' alt='' /></a></li>")
 					}
     				$("#KEGGScatterCarousel").jCarouselLite({
				        btnNext: ".default #KEGGScatterNext",
				        btnPrev: ".default #KEGGScatterPrev",
				        visible: 1,
				        speed: 800
				    });
				},    
				error : function(XMLHttpRequest) {
					alert(XMLHttpRequest.status +' '+ XMLHttpRequest.statusText);
				}
			});
		}
	});
	

})


/*-------------公共函数-------------------*/
function updateCheckTable(selectId,tableId,compareData){
		if(!compareData) return;
		debugger
		var p=$("#"+selectId).selectpicker("val");
		for(var j=0;j<compareData.length;j++){
			if(p==compareData[j]["compareName"]){
				var content=compareData[j]['content'];
				var head=content[0];
				var options={
					clickToSelect:true,
					showFooter:false,
					classes:'table',
					columns: [{field:"state",checkbox:true,checkboxEnabled:true}]
				}
				for(var m=0;m<head.length;m++){
					var obj={order: "asc"};
					obj["title"]=head[m];
					obj["field"]=head[m];
					options.columns.push(obj);
				}
				var tableData=[];
				for(var i=1;i<content.length;i++){
					var row=content[i];
					var rowObj={};
					for(var k=0;k<row.length;k++){
						rowObj[head[k]]=row[k];
					}
					tableData.push(rowObj);
				}
				$("#"+tableId).bootstrapTable('destroy');
				$("#"+tableId).bootstrapTable(options);
				$("#"+tableId).bootstrapTable('load',tableData);
			}
		}
	}
	function updateTable(selectId,tabPanelId,compareData){
		if(!compareData) return;
		var p=$("#"+selectId).selectpicker("val");
		for(var j=0;j<compareData.length;j++){
			if(p==compareData[j]["compareName"]){
				var content=compareData[j]['content'];
				var head=content[0];
				var options={
					clickToSelect:true,
					showFooter:false,
					classes:'table',
					columns: []
				}
				for(var m=0;m<head.length;m++){
					var obj={order: "asc"};
					obj["title"]=head[m];
					obj["field"]=head[m];
					options.columns.push(obj);
				}
				$("#"+tabPanelId+" table").bootstrapTable(options);
				var tableData=[];
				for(var i=1;i<content.length;i++){
					var row=content[i];
					var rowObj={};
					for(var k=0;k<row.length;k++){
						rowObj[head[k]]=row[k];
					}
					tableData.push(rowObj);
				}
				$("#"+tabPanelId+" table").bootstrapTable('destroy');
				$("#"+tabPanelId+" table").bootstrapTable(options);
				if(tableData.length<1000){
					$("#"+tabPanelId+" table").bootstrapTable('load',tableData);
				}else{
					var start = new Date().getTime();//起始时间
					var tableDataTemp=tableData.slice(0,300);
					$("#"+tabPanelId+" table").bootstrapTable('load',tableDataTemp);
					setTimeout(function(){
						tableDataTemp=tableData.slice(300,tableData.length);
						$("#"+tabPanelId+" table").bootstrapTable('append',tableDataTemp);
					},500)
					var end = new Date().getTime();//起始时间
					console.log(end-start)
					
				}
				
			}
		}
	}
//任务的状态
function taskState(State) {
	
    if ( State == 'done'){
			return  '<button class="btn btn-primary btn-xs" style="width:100px;">完成</button>';
		}else	if ( State == 'failed'){
			return '<button class="btn btn-warning btn-xs" style="width:100px;">中止</button>';
		}else if (State == 'ready'){
			return '<button class="btn  btn-xs" style="width:100px;">就绪/重运行</button>';
		}else if (State == 'pending'){
			return '<button class="btn btn-xs" style="width:100px;">等待中</button>';
		}
		else{
			return '<button class="btn btn-success btn-xs" style="width:100px;">运行中</button>';
		}
};	
	
//参数组装
function allParams(dom){
	var app = dom.serializeArray();
	var json1 = {};
	for(var i=0;i<app.length;i++){
			var name = app[i].name;
			var value = app[i].value;
			json1[name] = value;
	}
	return json1;
};

//-----------------------------------点击打开目录--------------------------------------------	
var samplesDataUrl = "json/jobUrl.json"; //像后台发送目录的地址
//打开任务目录
function opendir_path(id,outInputId){
	var inputValue = $("#"+id).val();  //当前input的值
	$("#inputUrl").val(inputValue);
	$('#selectUrl').modal('show');
    $("#selected").attr("onClick","geturl('#"+id+"','dir','#"+outInputId+"')")
};


//选择目录时添加文件或者目录的图标
function addIcon(State, row) {
	var typeChr = row.type.charAt(0);
		
	if(typeChr == 'd'){
		return '<span class="glyphicon glyphicon-folder-open"></span>';
		}
	else{
		return '<span class="glyphicon glyphicon-file"></span> ';
		}
};

//当模态框加载完成后给input中添加当前用户的根目录
$(function(){
  dblCilck('jobUrlTable','inputUrl',samplesDataUrl);
  $('#selectUrl').on('shown.bs.modal', function () {    //模态框完全显示之后把根目录放入
//	      	$("#inputUrl").val("/home/agloom");
  	if($("#inputUrl").val()==''){
  		$("#inputUrl").val('/');
  	}
  	checkUrl($("#inputUrl").val(), samplesDataUrl, 'inputUrl','jobUrlTable');
  });
});


//回车查目录是否存在
$(function(){
	$('#inputUrl').bind('keypress',function(event){
		if(event.keyCode == "13")    
		{
			newUrl = $("#inputUrl").val();
			checkUrl(newUrl,samplesDataUrl,"inputUrl","jobUrlTable"); //参数依次为需要检查的URL， 后台的地址， 需要更新的输入框id， 需要刷新的bootstrap table
		}
	});
//点击右边箭头，检查	
	$("#search").click(function(){  
    	  newUrl = $("#inputUrl").val();
		  checkUrl(newUrl,samplesDataUrl,"inputUrl","jobUrlTable");
    });  
//后退按钮
	$("#back").click(function(){  
    	   Url= $("#inputUrl").val();
		   
		   lastLen =Url.split('/').pop().length
		   newUrl = Url.substring(0,Url.length - lastLen-1);
		   checkUrl(newUrl,samplesDataUrl,"inputUrl","jobUrlTable");
    }); 
	
});

//点击选择关闭模态框，将当前模态框input中的路径取出放入表单中,type 的类型 暂时有两种，dir和 file
function geturl(formInputId,type,outInputId){
	var selected_num = checkedNum("jobUrlTable");
	if(type == "dir"){
		//只能选择文件夹，单选
		var newUrl = ""
		
		if(selected_num == 1){
			//此时选中了一项，判断是否是目录
			
			var singleName = ""   //选择一个文件夹或者文件的名字，单选
			$.map($('#jobUrlTable').bootstrapTable('getSelections'), function (row) {
				console.log(row);
				var d_f_type = "";
				d_f_type = row.type.charAt(0);
				if(d_f_type == "d"){
					singleName = row.name;
					newUrl = $("#inputUrl").val() + "/"+ singleName;    //点击选择时取input中当前的路径，在加上此时选择的
					if($(outInputId).val()==newUrl){
						alert("不能和输入目录相同！");
						return;
					}
					newUrl = newUrl.replace('//','/');
					$("#selected").removeAttr("onClick");   //选择按钮
					$("#selectUrl").modal('hide');          //隐藏目录选择的模态框
					$(formInputId).val(newUrl);	
					if(formInputId == "#data_dir"){
						var sequencingType = $("#seq_type").val();
						$.ajax({
								url:samplesDataUrl,  
								type:'get',
								data:{url:newUrl},
								dataType: "json",
								success:function(data,textStatus) {
									if(data['status']=='ERROR'){    //请求成功但没有执行成功
										alert(data['data']);
									}else{
										var data1 = data['data'];

										objData = dataTableGet(data1,sequencingType);   //向后台传输数据，返回值组成Json
										
										$('#sampleTable').bootstrapTable('load',objData);  //填入table中	
									}
								},    
								error : function(XMLHttpRequest) {
									alert(XMLHttpRequest.status +' '+ XMLHttpRequest.statusText);   
								}
						}); 
					
					};
				}else{
					alert("对不起，您选择的必须是目录文件！");
				
				};
						
			});
			
		
		}else if(selected_num == 0){
			//没有选中任何项，将此时的url传到前面

			newUrl = $("#inputUrl").val();    //点击选择时取input中当前的路径，在加上此时选择的
			newUrl = newUrl.replace('//','/');
			$("#selected").removeAttr("onClick");
			$("#selectUrl").modal('hide');
			$(formInputId).val(newUrl);

			var sequencingType = $("#seq_type").val();
			$.ajax({
					url:samplesDataUrl,  
					type:'get',
					data:{url:newUrl},
					dataType: "json",
					success:function(data,textStatus) {
						if(data['status']=='ERROR'){    //请求成功但没有执行成功
							alert(data['data']);
						}else{
							var data1 = data['data'];
							objData = dataTableGet(data1,sequencingType);   //向后台传输数据，返回值组成Json
							console.log(objData)
							$('#sampleTable').bootstrapTable('load',objData);  //填入table中
						}
					},    
					error : function(XMLHttpRequest) {
						alert(XMLHttpRequest.status +' '+ XMLHttpRequest.statusText);   
					}
			}); 
		}
		else{
			//选择了多项，直接报错
			alert("对不起，只能选择一个目录文件！");
		};
		
	}
	else if(type == "file"){
		//只能选择文件，多选
		var newUrl = ""
		var files = [];
		var have_dir = 0
		$.map($('#jobUrlTable').bootstrapTable('getSelections'), function (row) {
			var d_f_type = "";
			d_f_type = row.type.charAt(0);
			if(d_f_type == "d"){
				have_dir = 1;
			}else{
				files.push(row.name);
			}
			
		});
		if(have_dir == 1){
			alert("对不起，不能选择文件夹，只能选择文件！");
		}else{
			if(files.length == 0){
				alert("请选择文件！")
			}else{
				//获得当前的目录，取消绑定，关闭模态框，在外面填写
				newUrl = $("#inputUrl").val();
				newUrl = newUrl.replace('//','/');
				$("#selected").removeAttr("onClick");
				$("#selectUrl").modal('hide');
				$(formInputId).val(newUrl);
				//清空样本
				$(formInputId).nextAll().remove();
				for(var i=0; i< files.length; i++){
					$(formInputId).after('<span class="label label-default span_sample">'+files[i]+'<a href="javascript:void(0);" onclick="remover_this_sample(this)" class="glyphicon glyphicon-remove"></a></span>');
				};
			};
		};

	}
	else{
		return false;
	}

};

</script>


</body>

</html>